<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Pibox: fsm_rfid.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Pibox
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">fsm_rfid.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;dirent.h&gt;</code><br />
<code>#include &lt;sqlite3.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="dbcontroller_8h_source.html">dbcontroller.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fsm__rfid_8h_source.html">fsm_rfid.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mutex_8h_source.html">mutex.h</a>&quot;</code><br />
<code>#include &quot;menu_lcd.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_interrupt_s_m_8h_source.html">InterruptSM.h</a>&quot;</code><br />
</div>
<p><a href="fsm__rfid_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab840d057a03e1da1ef1b7e6d63a92d75"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#ab840d057a03e1da1ef1b7e6d63a92d75">DB_NAME</a>&#160;&#160;&#160;&quot;canciones_db.db&quot;</td></tr>
<tr class="separator:ab840d057a03e1da1ef1b7e6d63a92d75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7c0c16486a5a3e1579cc8e384d7f96a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#ad7c0c16486a5a3e1579cc8e384d7f96a">PIN_A</a>&#160;&#160;&#160;17</td></tr>
<tr class="separator:ad7c0c16486a5a3e1579cc8e384d7f96a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fda21ec50fc75d0fa9bbcb33bf560ff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a9fda21ec50fc75d0fa9bbcb33bf560ff">PIN_B</a>&#160;&#160;&#160;27</td></tr>
<tr class="separator:a9fda21ec50fc75d0fa9bbcb33bf560ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac31844038a274a4cfa6375484e3031f9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#ac31844038a274a4cfa6375484e3031f9">PIN_C</a>&#160;&#160;&#160;22</td></tr>
<tr class="separator:ac31844038a274a4cfa6375484e3031f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad065142efd1af84e099b32e5c1d5b74e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#ad065142efd1af84e099b32e5c1d5b74e">ConfiguraTarjeta</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:ad065142efd1af84e099b32e5c1d5b74e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configura la tarjeta en la base de datos Muestra un menu por pantalla e inicializa las interrupciones del, encoder para que funcionen solamente en este punto del programa.  <a href="#ad065142efd1af84e099b32e5c1d5b74e">More...</a><br /></td></tr>
<tr class="separator:ad065142efd1af84e099b32e5c1d5b74e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d41eb10204306890ce82365621c19bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a2d41eb10204306890ce82365621c19bd">ConfiguracionCorrecta</a> ()</td></tr>
<tr class="memdesc:a2d41eb10204306890ce82365621c19bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Desinicializacion tras la configuracion de una tarjeta Elimina todas las interrupciones asociadas al encoder e imprime por el lcd el mensaje de final de la configuracion.  <a href="#a2d41eb10204306890ce82365621c19bd">More...</a><br /></td></tr>
<tr class="separator:a2d41eb10204306890ce82365621c19bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8fb7a4b36bbf4474338e0c399b0f10b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#ac8fb7a4b36bbf4474338e0c399b0f10b">BuscaTarjeta</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:ac8fb7a4b36bbf4474338e0c399b0f10b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Funcion de Busqueda de la tarjeta en la Db Busca si existe la tarjeta en la base de datos, en funcion de este resultado activa los flags de FLAG_CARD_EXIST o no.  <a href="#ac8fb7a4b36bbf4474338e0c399b0f10b">More...</a><br /></td></tr>
<tr class="separator:ac8fb7a4b36bbf4474338e0c399b0f10b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a7d69d31f9de9f46f7708405862da52"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a2a7d69d31f9de9f46f7708405862da52">UUID_2_int</a> ()</td></tr>
<tr class="memdesc:a2a7d69d31f9de9f46f7708405862da52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Conversor de Int Array a int del UUID.  <a href="#a2a7d69d31f9de9f46f7708405862da52">More...</a><br /></td></tr>
<tr class="separator:a2a7d69d31f9de9f46f7708405862da52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4fd7a06a67d4e3d914a6293dee6b661"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#ab4fd7a06a67d4e3d914a6293dee6b661">menu_display_stepper_plus</a> (<a class="el" href="fsm__rfid_8h.html#a85839a66c9eb826246b8cd0b5652c26f">list_files_t</a> *lista)</td></tr>
<tr class="memdesc:ab4fd7a06a67d4e3d914a6293dee6b661"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refresco del LCD con los parametros de la lista Funcion de manejo del menu que se actualiza en funcion de lo que se haya operado en la funcion lista, para poder mostrar un menu rotativo bidireccional por el LCD. Anade en la primera linea del LCD el promt de seleccion.  <a href="#ab4fd7a06a67d4e3d914a6293dee6b661">More...</a><br /></td></tr>
<tr class="separator:ab4fd7a06a67d4e3d914a6293dee6b661"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fb305adea1f2ff378f4560e1445bce2"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a5fb305adea1f2ff378f4560e1445bce2">get_next_file</a> (<a class="el" href="fsm__rfid_8h.html#a85839a66c9eb826246b8cd0b5652c26f">list_files_t</a> *lista)</td></tr>
<tr class="memdesc:a5fb305adea1f2ff378f4560e1445bce2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Se mueve una posicion hacia delante el punero de fichero actual.  <a href="#a5fb305adea1f2ff378f4560e1445bce2">More...</a><br /></td></tr>
<tr class="separator:a5fb305adea1f2ff378f4560e1445bce2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1988eab9789e5d3a43e9da8ab6efe4cf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fsm__rfid_8h.html#a85839a66c9eb826246b8cd0b5652c26f">list_files_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a1988eab9789e5d3a43e9da8ab6efe4cf">get_list_files</a> (char *route)</td></tr>
<tr class="memdesc:a1988eab9789e5d3a43e9da8ab6efe4cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Crea una estrucutura de tipo lista en el directorio pasado como parametro Reserva memoria para una estructura de tipo lista de ficheros y la rellena con los datos del directorio que se esta escaneando.  <a href="#a1988eab9789e5d3a43e9da8ab6efe4cf">More...</a><br /></td></tr>
<tr class="separator:a1988eab9789e5d3a43e9da8ab6efe4cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a087470326fb60619195e0bc275a83191"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fsm__rfid_8h.html#a85839a66c9eb826246b8cd0b5652c26f">list_files_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a087470326fb60619195e0bc275a83191">new_list_files</a> (int num_files)</td></tr>
<tr class="memdesc:a087470326fb60619195e0bc275a83191"><td class="mdescLeft">&#160;</td><td class="mdescRight">Devuelve una estructura con memoria reservada y parametros por defecto.  <a href="#a087470326fb60619195e0bc275a83191">More...</a><br /></td></tr>
<tr class="separator:a087470326fb60619195e0bc275a83191"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe523c2456ee5991ac24ccaef49a56c8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#afe523c2456ee5991ac24ccaef49a56c8">get_number_files</a> (char *route)</td></tr>
<tr class="memdesc:afe523c2456ee5991ac24ccaef49a56c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cuenta el numero de ficheros que hay en la ruta.  <a href="#afe523c2456ee5991ac24ccaef49a56c8">More...</a><br /></td></tr>
<tr class="separator:afe523c2456ee5991ac24ccaef49a56c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a913e96d4f89df237a1250877f82291c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a913e96d4f89df237a1250877f82291c7">ISR</a> (int <a class="el" href="_interrupt_s_m_8h.html#a3b65133bb9997cd1ccf311af0927fc9e">event</a>)</td></tr>
<tr class="memdesc:a913e96d4f89df237a1250877f82291c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registra las interrupciones del Encoder.  <a href="#a913e96d4f89df237a1250877f82291c7">More...</a><br /></td></tr>
<tr class="separator:a913e96d4f89df237a1250877f82291c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d4c8489d18eb87542e04359532017f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a7d4c8489d18eb87542e04359532017f2">select_mode</a> (int <a class="el" href="_interrupt_s_m_8h.html#a3b65133bb9997cd1ccf311af0927fc9e">event</a>)</td></tr>
<tr class="memdesc:a7d4c8489d18eb87542e04359532017f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback de boton del encoder Activa el flag de seleccion del encoder.  <a href="#a7d4c8489d18eb87542e04359532017f2">More...</a><br /></td></tr>
<tr class="separator:a7d4c8489d18eb87542e04359532017f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a894af73d089c430c2524bbb8015e749a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a894af73d089c430c2524bbb8015e749a">CompruebaComienzo</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:a894af73d089c430c2524bbb8015e749a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Funcion de arranque del sistema devuelve siempre 1.  <a href="#a894af73d089c430c2524bbb8015e749a">More...</a><br /></td></tr>
<tr class="separator:a894af73d089c430c2524bbb8015e749a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea3d64c12349f394154fb635e17c08f1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#aea3d64c12349f394154fb635e17c08f1">CompruebaFinalReproduccion</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:aea3d64c12349f394154fb635e17c08f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Condición de paso si Ha acabado la reproducción de la cancion.  <a href="#aea3d64c12349f394154fb635e17c08f1">More...</a><br /></td></tr>
<tr class="separator:aea3d64c12349f394154fb635e17c08f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25dc50da91baf30a6ef7a6cf3277ab4b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a25dc50da91baf30a6ef7a6cf3277ab4b">TarjetaDisponible</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:a25dc50da91baf30a6ef7a6cf3277ab4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Condición de paso si hay una tarjeta insertada en el optoacoplador.  <a href="#a25dc50da91baf30a6ef7a6cf3277ab4b">More...</a><br /></td></tr>
<tr class="separator:a25dc50da91baf30a6ef7a6cf3277ab4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ce43ebc72dfc36e9b3f542ac4c42143"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a6ce43ebc72dfc36e9b3f542ac4c42143">TarjetaNoDisponible</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:a6ce43ebc72dfc36e9b3f542ac4c42143"><td class="mdescLeft">&#160;</td><td class="mdescRight">Condición de paso si no hay una tarjeta insertada en el optoacoplador.  <a href="#a6ce43ebc72dfc36e9b3f542ac4c42143">More...</a><br /></td></tr>
<tr class="separator:a6ce43ebc72dfc36e9b3f542ac4c42143"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2395018b43d089e28965e7993fc7796f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a2395018b43d089e28965e7993fc7796f">TarjetaValida</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:a2395018b43d089e28965e7993fc7796f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Condición de paso si la tarjeta es RFID.  <a href="#a2395018b43d089e28965e7993fc7796f">More...</a><br /></td></tr>
<tr class="separator:a2395018b43d089e28965e7993fc7796f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7077c53d7693ce4e43ab1f3500ba7464"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a7077c53d7693ce4e43ab1f3500ba7464">TarjetaNoValida</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:a7077c53d7693ce4e43ab1f3500ba7464"><td class="mdescLeft">&#160;</td><td class="mdescRight">Condición de paso si la tarjeta no es RFID.  <a href="#a7077c53d7693ce4e43ab1f3500ba7464">More...</a><br /></td></tr>
<tr class="separator:a7077c53d7693ce4e43ab1f3500ba7464"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bf6bef8226a73e69999b66ab1c4d1ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a2bf6bef8226a73e69999b66ab1c4d1ce">EsperaTargeta</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:a2bf6bef8226a73e69999b66ab1c4d1ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Funcion de espera de la tarjeta mientras no haya una en el optoacoplador.  <a href="#a2bf6bef8226a73e69999b66ab1c4d1ce">More...</a><br /></td></tr>
<tr class="separator:a2bf6bef8226a73e69999b66ab1c4d1ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f0ba74b305da68c1f2969dd64042d8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a2f0ba74b305da68c1f2969dd64042d8b">DescartaTarjeta</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:a2f0ba74b305da68c1f2969dd64042d8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Altera el flag de tarjeta insertada.  <a href="#a2f0ba74b305da68c1f2969dd64042d8b">More...</a><br /></td></tr>
<tr class="separator:a2f0ba74b305da68c1f2969dd64042d8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b8679a64ad408caa001f99dd8f4ef88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a1b8679a64ad408caa001f99dd8f4ef88">LeerTarjeta</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:a1b8679a64ad408caa001f99dd8f4ef88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lee la tarjeta, activa el flag de tarjeta valida Lee la tarjeta, almacena en una variable privada del fichero el UUID de la misma. Activa el flag de tarjeta valida.  <a href="#a1b8679a64ad408caa001f99dd8f4ef88">More...</a><br /></td></tr>
<tr class="separator:a1b8679a64ad408caa001f99dd8f4ef88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9557ef798d31cdbbe31de3713b8d9a3d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a9557ef798d31cdbbe31de3713b8d9a3d">ComienzaReproduccion</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:a9557ef798d31cdbbe31de3713b8d9a3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Activa el flag de inicio de reproduccion de la maquina de estados de player.  <a href="#a9557ef798d31cdbbe31de3713b8d9a3d">More...</a><br /></td></tr>
<tr class="separator:a9557ef798d31cdbbe31de3713b8d9a3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d872b86674c5ebc4e21793d76e75140"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a5d872b86674c5ebc4e21793d76e75140">CancelaReproduccion</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:a5d872b86674c5ebc4e21793d76e75140"><td class="mdescLeft">&#160;</td><td class="mdescRight">Activa el flag de inicio de stop de la maquina de estados de player.  <a href="#a5d872b86674c5ebc4e21793d76e75140">More...</a><br /></td></tr>
<tr class="separator:a5d872b86674c5ebc4e21793d76e75140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a126312373885d78d67af9013bc12fa4e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a126312373885d78d67af9013bc12fa4e">CompruebaTarjeta</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:a126312373885d78d67af9013bc12fa4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Funcion de espera de comprueba tarjeta.  <a href="#a126312373885d78d67af9013bc12fa4e">More...</a><br /></td></tr>
<tr class="separator:a126312373885d78d67af9013bc12fa4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad61e8abe347c0fe4e1fa343f2a3dde2f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#ad61e8abe347c0fe4e1fa343f2a3dde2f">FinalizaReproduccion</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:ad61e8abe347c0fe4e1fa343f2a3dde2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Funcion de finalizacion de reproduccion.  <a href="#ad61e8abe347c0fe4e1fa343f2a3dde2f">More...</a><br /></td></tr>
<tr class="separator:ad61e8abe347c0fe4e1fa343f2a3dde2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1f623c126d57fab4c99a247e7ba3766"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#ab1f623c126d57fab4c99a247e7ba3766">ComienzaSistema</a> (<a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *fsm)</td></tr>
<tr class="memdesc:ab1f623c126d57fab4c99a247e7ba3766"><td class="mdescLeft">&#160;</td><td class="mdescRight">Funcion de Inicizalizacion del sistema.  <a href="#ab1f623c126d57fab4c99a247e7ba3766">More...</a><br /></td></tr>
<tr class="separator:ab1f623c126d57fab4c99a247e7ba3766"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ad6b3a023f7f39cfc2d607f2c26dd9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a1ad6b3a023f7f39cfc2d607f2c26dd9b">lp</a> (void *userData)</td></tr>
<tr class="memdesc:a1ad6b3a023f7f39cfc2d607f2c26dd9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Funcion de loop infinito de la maquina de estados.  <a href="#a1ad6b3a023f7f39cfc2d607f2c26dd9b">More...</a><br /></td></tr>
<tr class="separator:a1ad6b3a023f7f39cfc2d607f2c26dd9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa239886bea26a31d0f6ddf5137a804cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#aa239886bea26a31d0f6ddf5137a804cb">launchRFID</a> ()</td></tr>
<tr class="memdesc:aa239886bea26a31d0f6ddf5137a804cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Funcion de creacion de la maquina de estados Si la maquina de estados ya esta creada no se crea otra.  <a href="#aa239886bea26a31d0f6ddf5137a804cb">More...</a><br /></td></tr>
<tr class="separator:aa239886bea26a31d0f6ddf5137a804cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a822642377d33813dcd95207d8a339282"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a822642377d33813dcd95207d8a339282">killRFID</a> ()</td></tr>
<tr class="memdesc:a822642377d33813dcd95207d8a339282"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mata la maquina de estados del rfid.  <a href="#a822642377d33813dcd95207d8a339282">More...</a><br /></td></tr>
<tr class="separator:a822642377d33813dcd95207d8a339282"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e5e6e0d90b0435a4ce38504eccf243a"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a8e5e6e0d90b0435a4ce38504eccf243a">get_last_file</a> (<a class="el" href="fsm__rfid_8h.html#a85839a66c9eb826246b8cd0b5652c26f">list_files_t</a> *lista)</td></tr>
<tr class="memdesc:a8e5e6e0d90b0435a4ce38504eccf243a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Se mueve una posicion hacia atrás el punero de fichero actual.  <a href="#a8e5e6e0d90b0435a4ce38504eccf243a">More...</a><br /></td></tr>
<tr class="separator:a8e5e6e0d90b0435a4ce38504eccf243a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ce218ec7a3ff28da1c3747e07410d9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a9ce218ec7a3ff28da1c3747e07410d9f">clean_list_files</a> (<a class="el" href="fsm__rfid_8h.html#a85839a66c9eb826246b8cd0b5652c26f">list_files_t</a> *lista)</td></tr>
<tr class="memdesc:a9ce218ec7a3ff28da1c3747e07410d9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor de una lista creada.  <a href="#a9ce218ec7a3ff28da1c3747e07410d9f">More...</a><br /></td></tr>
<tr class="separator:a9ce218ec7a3ff28da1c3747e07410d9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a414378ace9198797d96ba624749060e0"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a414378ace9198797d96ba624749060e0">UUID</a> [16]</td></tr>
<tr class="memdesc:a414378ace9198797d96ba624749060e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable privada con el UUID de la ultima tarjeta.  <a href="#a414378ace9198797d96ba624749060e0">More...</a><br /></td></tr>
<tr class="separator:a414378ace9198797d96ba624749060e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc76c8cbae64e5426e49144ac52ac6d5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#adc76c8cbae64e5426e49144ac52ac6d5">maquina_creada</a> = 0</td></tr>
<tr class="memdesc:adc76c8cbae64e5426e49144ac52ac6d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indica si la maquina de estados ha sido creada ya o no.  <a href="#adc76c8cbae64e5426e49144ac52ac6d5">More...</a><br /></td></tr>
<tr class="separator:adc76c8cbae64e5426e49144ac52ac6d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b63db81023235b2ef3108ad324a58f8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fsm_8h.html#a6b1de28e7a9f91913bb0499e2584b5ac">fsm_trans_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a1b63db81023235b2ef3108ad324a58f8">transition_table_rfid</a> []</td></tr>
<tr class="separator:a1b63db81023235b2ef3108ad324a58f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefd9aadc5bca10986d4506c0b045be65"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#aefd9aadc5bca10986d4506c0b045be65">seqA</a></td></tr>
<tr class="separator:aefd9aadc5bca10986d4506c0b045be65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f153a44052f2c810d14272facac0f82"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__rfid_8c.html#a7f153a44052f2c810d14272facac0f82">seqB</a></td></tr>
<tr class="separator:a7f153a44052f2c810d14272facac0f82"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ab840d057a03e1da1ef1b7e6d63a92d75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab840d057a03e1da1ef1b7e6d63a92d75">&#9670;&nbsp;</a></span>DB_NAME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DB_NAME&#160;&#160;&#160;&quot;canciones_db.db&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00020">20</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>

</div>
</div>
<a id="ad7c0c16486a5a3e1579cc8e384d7f96a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7c0c16486a5a3e1579cc8e384d7f96a">&#9670;&nbsp;</a></span>PIN_A</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_A&#160;&#160;&#160;17</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00021">21</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>

</div>
</div>
<a id="a9fda21ec50fc75d0fa9bbcb33bf560ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fda21ec50fc75d0fa9bbcb33bf560ff">&#9670;&nbsp;</a></span>PIN_B</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_B&#160;&#160;&#160;27</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00022">22</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>

</div>
</div>
<a id="ac31844038a274a4cfa6375484e3031f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac31844038a274a4cfa6375484e3031f9">&#9670;&nbsp;</a></span>PIN_C</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_C&#160;&#160;&#160;22</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00023">23</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac8fb7a4b36bbf4474338e0c399b0f10b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8fb7a4b36bbf4474338e0c399b0f10b">&#9670;&nbsp;</a></span>BuscaTarjeta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BuscaTarjeta </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Funcion de Busqueda de la tarjeta en la Db Busca si existe la tarjeta en la base de datos, en funcion de este resultado activa los flags de FLAG_CARD_EXIST o no. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td>Maquina de estados </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00305">305</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;{</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">//Iniciamos la base de datos</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    sqlite3 *db = <a class="code" href="dbcontroller_8c.html#a6c03e23326b03a2084159378345e6fcf">db_load</a>(<a class="code" href="fsm__rfid_8c.html#ab840d057a03e1da1ef1b7e6d63a92d75">DB_NAME</a>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(5);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    printf(<span class="stringliteral">&quot;UUID: %d&quot;</span>, <a class="code" href="fsm__rfid_8c.html#a2a7d69d31f9de9f46f7708405862da52">UUID_2_int</a>());</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">//Busca el nombre en la base de datos</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="tipos_8h.html#aad2bf680e32d8de23ad37cb9980150c0">song_name</a> = <a class="code" href="dbcontroller_8c.html#afa05bc6d059b49ba25da7afa536e29a9">db_get_song_name</a>(db, <a class="code" href="fsm__rfid_8c.html#a2a7d69d31f9de9f46f7708405862da52">UUID_2_int</a>());</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    printf(<span class="stringliteral">&quot;SALGO \n&quot;</span>);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    delay(10);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    printf(<span class="stringliteral">&quot;SongName: %s&quot;</span>, <a class="code" href="tipos_8h.html#aad2bf680e32d8de23ad37cb9980150c0">song_name</a>);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    fflush(stdout);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">//Si el puntero song_name es nulo no existe en la DB</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tipos_8h.html#aad2bf680e32d8de23ad37cb9980150c0">song_name</a> == NULL)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(5);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        printf(<span class="stringliteral">&quot;Error con los datos de la db \n&quot;</span>);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="comment">//Activamos el flag de no existir</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(0);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <a class="code" href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a> |= ~<a class="code" href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaa1f645d352eaa50d8703a11c539e04b22">FLAG_CARD_EXIST</a>;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(0);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(5);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">//Activamos el flag de existir</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(0);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a> |= <a class="code" href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaa1f645d352eaa50d8703a11c539e04b22">FLAG_CARD_EXIST</a>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(0);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">//Display por el LCD</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="dbcontroller_8c.html#ae07af262c608d2e3de291268d923d24a">db_close</a>(db);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div><div class="ttc" id="mutex_8c_html_aa5fdb07cba530aae1495d95be367d04a"><div class="ttname"><a href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a></div><div class="ttdeci">void unlock(int key)</div><div class="ttdoc">desloquea el hilo actual </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00025">mutex.c:25</a></div></div>
<div class="ttc" id="mutex_8c_html_ad649ab53814d18a30bb40d7242961e23"><div class="ttname"><a href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a></div><div class="ttdeci">void lock(int key)</div><div class="ttdoc">Bloquea el hilo actual. </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00016">mutex.c:16</a></div></div>
<div class="ttc" id="dbcontroller_8c_html_ae07af262c608d2e3de291268d923d24a"><div class="ttname"><a href="dbcontroller_8c.html#ae07af262c608d2e3de291268d923d24a">db_close</a></div><div class="ttdeci">void db_close(sqlite3 *db)</div><div class="ttdoc">Cierra la base de datos y libera la memoria asignada al puntero. </div><div class="ttdef"><b>Definition:</b> <a href="dbcontroller_8c_source.html#l00203">dbcontroller.c:203</a></div></div>
<div class="ttc" id="tipos_8h_html_aad2bf680e32d8de23ad37cb9980150c0"><div class="ttname"><a href="tipos_8h.html#aad2bf680e32d8de23ad37cb9980150c0">song_name</a></div><div class="ttdeci">volatile char * song_name</div><div class="ttdoc">numbre del fichero </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00043">tipos.h:43</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a2a7d69d31f9de9f46f7708405862da52"><div class="ttname"><a href="fsm__rfid_8c.html#a2a7d69d31f9de9f46f7708405862da52">UUID_2_int</a></div><div class="ttdeci">int UUID_2_int()</div><div class="ttdoc">Conversor de Int Array a int del UUID. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00570">fsm_rfid.c:570</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_ab840d057a03e1da1ef1b7e6d63a92d75"><div class="ttname"><a href="fsm__rfid_8c.html#ab840d057a03e1da1ef1b7e6d63a92d75">DB_NAME</a></div><div class="ttdeci">#define DB_NAME</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00020">fsm_rfid.c:20</a></div></div>
<div class="ttc" id="fsm__rfid_8h_html_abdc0ff505cbd4c3a6fc0eee64ca2ddcaa1f645d352eaa50d8703a11c539e04b22"><div class="ttname"><a href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaa1f645d352eaa50d8703a11c539e04b22">FLAG_CARD_EXIST</a></div><div class="ttdoc">Flag tarjeta Existe. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00035">fsm_rfid.h:35</a></div></div>
<div class="ttc" id="tipos_8h_html_a23e04a79e83a0bb62dc3d6be4e0d1b92"><div class="ttname"><a href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a></div><div class="ttdeci">volatile uint8_t flag_rfid</div><div class="ttdoc">flags del rfid </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00041">tipos.h:41</a></div></div>
<div class="ttc" id="dbcontroller_8c_html_a6c03e23326b03a2084159378345e6fcf"><div class="ttname"><a href="dbcontroller_8c.html#a6c03e23326b03a2084159378345e6fcf">db_load</a></div><div class="ttdeci">sqlite3 * db_load(char *file_dir)</div><div class="ttdef"><b>Definition:</b> <a href="dbcontroller_8c_source.html#l00042">dbcontroller.c:42</a></div></div>
<div class="ttc" id="dbcontroller_8c_html_afa05bc6d059b49ba25da7afa536e29a9"><div class="ttname"><a href="dbcontroller_8c.html#afa05bc6d059b49ba25da7afa536e29a9">db_get_song_name</a></div><div class="ttdeci">char * db_get_song_name(sqlite3 *db, int user_id)</div><div class="ttdoc">Ejecuta la query de busqueda del nombre de la canción dado un ID Hace una query de busqueda del fiche...</div><div class="ttdef"><b>Definition:</b> <a href="dbcontroller_8c_source.html#l00157">dbcontroller.c:157</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d872b86674c5ebc4e21793d76e75140"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d872b86674c5ebc4e21793d76e75140">&#9670;&nbsp;</a></span>CancelaReproduccion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CancelaReproduccion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Activa el flag de inicio de stop de la maquina de estados de player. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td>Maquina de estados </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00225">225</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;{</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(1);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="tipos_8h.html#a8d6cbadfb1878d67dffef9647ba5fe05">flags_player</a> |= <a class="code" href="tipos_8h.html#abe8b7d04534b17feedbf65d3d40a28ef">FLAG_END</a>;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(1);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div><div class="ttc" id="tipos_8h_html_a8d6cbadfb1878d67dffef9647ba5fe05"><div class="ttname"><a href="tipos_8h.html#a8d6cbadfb1878d67dffef9647ba5fe05">flags_player</a></div><div class="ttdeci">volatile uint8_t flags_player</div><div class="ttdoc">flags del player </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00040">tipos.h:40</a></div></div>
<div class="ttc" id="mutex_8c_html_aa5fdb07cba530aae1495d95be367d04a"><div class="ttname"><a href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a></div><div class="ttdeci">void unlock(int key)</div><div class="ttdoc">desloquea el hilo actual </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00025">mutex.c:25</a></div></div>
<div class="ttc" id="mutex_8c_html_ad649ab53814d18a30bb40d7242961e23"><div class="ttname"><a href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a></div><div class="ttdeci">void lock(int key)</div><div class="ttdoc">Bloquea el hilo actual. </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00016">mutex.c:16</a></div></div>
<div class="ttc" id="tipos_8h_html_abe8b7d04534b17feedbf65d3d40a28ef"><div class="ttname"><a href="tipos_8h.html#abe8b7d04534b17feedbf65d3d40a28ef">FLAG_END</a></div><div class="ttdeci">#define FLAG_END</div><div class="ttdoc">Flag fin de cancion. </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00031">tipos.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ce218ec7a3ff28da1c3747e07410d9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ce218ec7a3ff28da1c3747e07410d9f">&#9670;&nbsp;</a></span>clean_list_files()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clean_list_files </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm__rfid_8h.html#a85839a66c9eb826246b8cd0b5652c26f">list_files_t</a> *&#160;</td>
          <td class="paramname"><em>lista</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor de una lista creada. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lista</td><td>estructura que se quiere eliminar de la memoria </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00555">555</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;{</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; lista-&gt;<a class="code" href="structlist__files.html#a70fbdb4ac81ecb8a257691170b40f4bb">num_files</a>; i++)</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    {</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        free(lista-&gt;<a class="code" href="structlist__files.html#ac683a830b7c1fd9d1fdee795b2b5e8a0">name_file</a>[i]);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    free(lista-&gt;<a class="code" href="structlist__files.html#ac683a830b7c1fd9d1fdee795b2b5e8a0">name_file</a>);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    free(lista);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;}</div><div class="ttc" id="structlist__files_html_ac683a830b7c1fd9d1fdee795b2b5e8a0"><div class="ttname"><a href="structlist__files.html#ac683a830b7c1fd9d1fdee795b2b5e8a0">list_files::name_file</a></div><div class="ttdeci">char ** name_file</div><div class="ttdoc">Lista de Strings. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00027">fsm_rfid.h:27</a></div></div>
<div class="ttc" id="structlist__files_html_a70fbdb4ac81ecb8a257691170b40f4bb"><div class="ttname"><a href="structlist__files.html#a70fbdb4ac81ecb8a257691170b40f4bb">list_files::num_files</a></div><div class="ttdeci">int num_files</div><div class="ttdoc">Numero de ficheros totales. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00024">fsm_rfid.h:24</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9557ef798d31cdbbe31de3713b8d9a3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9557ef798d31cdbbe31de3713b8d9a3d">&#9670;&nbsp;</a></span>ComienzaReproduccion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComienzaReproduccion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Activa el flag de inicio de reproduccion de la maquina de estados de player. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td>Maquina de estados </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00212">212</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    menu_lcd_display(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Playing: &quot;</span>, <a class="code" href="tipos_8h.html#aad2bf680e32d8de23ad37cb9980150c0">song_name</a>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(1);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="tipos_8h.html#a8d6cbadfb1878d67dffef9647ba5fe05">flags_player</a> = <a class="code" href="tipos_8h.html#aca7482b8a25290ec56826ad3b8d6bf19">FLAG_START</a>;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(1);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    printf(<span class="stringliteral">&quot;comienzas flag: %d&quot;</span>, <a class="code" href="tipos_8h.html#a8d6cbadfb1878d67dffef9647ba5fe05">flags_player</a>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div><div class="ttc" id="tipos_8h_html_a8d6cbadfb1878d67dffef9647ba5fe05"><div class="ttname"><a href="tipos_8h.html#a8d6cbadfb1878d67dffef9647ba5fe05">flags_player</a></div><div class="ttdeci">volatile uint8_t flags_player</div><div class="ttdoc">flags del player </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00040">tipos.h:40</a></div></div>
<div class="ttc" id="mutex_8c_html_aa5fdb07cba530aae1495d95be367d04a"><div class="ttname"><a href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a></div><div class="ttdeci">void unlock(int key)</div><div class="ttdoc">desloquea el hilo actual </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00025">mutex.c:25</a></div></div>
<div class="ttc" id="mutex_8c_html_ad649ab53814d18a30bb40d7242961e23"><div class="ttname"><a href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a></div><div class="ttdeci">void lock(int key)</div><div class="ttdoc">Bloquea el hilo actual. </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00016">mutex.c:16</a></div></div>
<div class="ttc" id="tipos_8h_html_aca7482b8a25290ec56826ad3b8d6bf19"><div class="ttname"><a href="tipos_8h.html#aca7482b8a25290ec56826ad3b8d6bf19">FLAG_START</a></div><div class="ttdeci">#define FLAG_START</div><div class="ttdoc">Flag de inicio de player. </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00032">tipos.h:32</a></div></div>
<div class="ttc" id="tipos_8h_html_aad2bf680e32d8de23ad37cb9980150c0"><div class="ttname"><a href="tipos_8h.html#aad2bf680e32d8de23ad37cb9980150c0">song_name</a></div><div class="ttdeci">volatile char * song_name</div><div class="ttdoc">numbre del fichero </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00043">tipos.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab1f623c126d57fab4c99a247e7ba3766"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1f623c126d57fab4c99a247e7ba3766">&#9670;&nbsp;</a></span>ComienzaSistema()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComienzaSistema </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Funcion de Inicizalizacion del sistema. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td>Maquina de estados </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00256">256</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;{</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    printf(<span class="stringliteral">&quot;Arranca el RFID&quot;</span>);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    menu_lcd_display_clear(),</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        menu_lcd_display(<span class="stringliteral">&quot;PiMusicBox Player!&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    fflush(stdout);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">//Si no es la primera inicialización no ocurre nada aqui</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span> (RC522_Init() == STATUS_ERROR)</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        printf(<span class="stringliteral">&quot;ERROR! \n&quot;</span>);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">//Reset de todos los flags</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(0);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a> = 0;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(0);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;}</div><div class="ttc" id="mutex_8c_html_aa5fdb07cba530aae1495d95be367d04a"><div class="ttname"><a href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a></div><div class="ttdeci">void unlock(int key)</div><div class="ttdoc">desloquea el hilo actual </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00025">mutex.c:25</a></div></div>
<div class="ttc" id="mutex_8c_html_ad649ab53814d18a30bb40d7242961e23"><div class="ttname"><a href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a></div><div class="ttdeci">void lock(int key)</div><div class="ttdoc">Bloquea el hilo actual. </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00016">mutex.c:16</a></div></div>
<div class="ttc" id="tipos_8h_html_a23e04a79e83a0bb62dc3d6be4e0d1b92"><div class="ttname"><a href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a></div><div class="ttdeci">volatile uint8_t flag_rfid</div><div class="ttdoc">flags del rfid </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00041">tipos.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a894af73d089c430c2524bbb8015e749a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a894af73d089c430c2524bbb8015e749a">&#9670;&nbsp;</a></span>CompruebaComienzo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CompruebaComienzo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Funcion de arranque del sistema devuelve siempre 1. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int, siempre 1 </dd></dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00103">103</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="aea3d64c12349f394154fb635e17c08f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea3d64c12349f394154fb635e17c08f1">&#9670;&nbsp;</a></span>CompruebaFinalReproduccion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CompruebaFinalReproduccion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Condición de paso si Ha acabado la reproducción de la cancion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td>Maquina de estados </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Condición cumplida o no </dd></dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00113">113</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;{</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(0);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    uint8_t tmp = (<a class="code" href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a> &amp; <a class="code" href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaa931e5ce4a8ef8e85a5ba096321891ded">FLAG_SYSTEM_END</a>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(0);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div><div class="ttc" id="mutex_8c_html_aa5fdb07cba530aae1495d95be367d04a"><div class="ttname"><a href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a></div><div class="ttdeci">void unlock(int key)</div><div class="ttdoc">desloquea el hilo actual </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00025">mutex.c:25</a></div></div>
<div class="ttc" id="mutex_8c_html_ad649ab53814d18a30bb40d7242961e23"><div class="ttname"><a href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a></div><div class="ttdeci">void lock(int key)</div><div class="ttdoc">Bloquea el hilo actual. </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00016">mutex.c:16</a></div></div>
<div class="ttc" id="fsm__rfid_8h_html_abdc0ff505cbd4c3a6fc0eee64ca2ddcaa931e5ce4a8ef8e85a5ba096321891ded"><div class="ttname"><a href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaa931e5ce4a8ef8e85a5ba096321891ded">FLAG_SYSTEM_END</a></div><div class="ttdoc">Final del sistema. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00034">fsm_rfid.h:34</a></div></div>
<div class="ttc" id="tipos_8h_html_a23e04a79e83a0bb62dc3d6be4e0d1b92"><div class="ttname"><a href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a></div><div class="ttdeci">volatile uint8_t flag_rfid</div><div class="ttdoc">flags del rfid </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00041">tipos.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a126312373885d78d67af9013bc12fa4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a126312373885d78d67af9013bc12fa4e">&#9670;&nbsp;</a></span>CompruebaTarjeta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CompruebaTarjeta </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Funcion de espera de comprueba tarjeta. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td>Maquina de estados </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00236">236</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;{</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a2d41eb10204306890ce82365621c19bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d41eb10204306890ce82365621c19bd">&#9670;&nbsp;</a></span>ConfiguracionCorrecta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ConfiguracionCorrecta </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Desinicializacion tras la configuracion de una tarjeta Elimina todas las interrupciones asociadas al encoder e imprime por el lcd el mensaje de final de la configuracion. </p>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00399">399</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;{</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    printf(<span class="stringliteral">&quot;Configuracion Correcta \n&quot;</span>);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <a class="code" href="_interrupt_s_m_8c.html#a411bdf6367b78a102b483d9ba31b9781">deleteIsr</a>(<a class="code" href="fsm__rfid_8c.html#ad7c0c16486a5a3e1579cc8e384d7f96a">PIN_A</a>);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="_interrupt_s_m_8c.html#a411bdf6367b78a102b483d9ba31b9781">deleteIsr</a>(<a class="code" href="fsm__rfid_8c.html#a9fda21ec50fc75d0fa9bbcb33bf560ff">PIN_B</a>);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="_interrupt_s_m_8c.html#a411bdf6367b78a102b483d9ba31b9781">deleteIsr</a>(<a class="code" href="fsm__rfid_8c.html#ac31844038a274a4cfa6375484e3031f9">PIN_C</a>);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    menu_lcd_display_clear();</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    menu_lcd_display(<span class="stringliteral">&quot;Finalizado!&quot;</span>, <span class="stringliteral">&quot; Retire la&quot;</span>, <span class="stringliteral">&quot;tarjeta&quot;</span>, <span class="stringliteral">&quot;:D&quot;</span>);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;}</div><div class="ttc" id="fsm__rfid_8c_html_a9fda21ec50fc75d0fa9bbcb33bf560ff"><div class="ttname"><a href="fsm__rfid_8c.html#a9fda21ec50fc75d0fa9bbcb33bf560ff">PIN_B</a></div><div class="ttdeci">#define PIN_B</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00022">fsm_rfid.c:22</a></div></div>
<div class="ttc" id="_interrupt_s_m_8c_html_a411bdf6367b78a102b483d9ba31b9781"><div class="ttname"><a href="_interrupt_s_m_8c.html#a411bdf6367b78a102b483d9ba31b9781">deleteIsr</a></div><div class="ttdeci">void deleteIsr(uint8_t PIN)</div><div class="ttdoc">Elimina la interrupcion del pin especificado. </div><div class="ttdef"><b>Definition:</b> <a href="_interrupt_s_m_8c_source.html#l00095">InterruptSM.c:95</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_ad7c0c16486a5a3e1579cc8e384d7f96a"><div class="ttname"><a href="fsm__rfid_8c.html#ad7c0c16486a5a3e1579cc8e384d7f96a">PIN_A</a></div><div class="ttdeci">#define PIN_A</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00021">fsm_rfid.c:21</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_ac31844038a274a4cfa6375484e3031f9"><div class="ttname"><a href="fsm__rfid_8c.html#ac31844038a274a4cfa6375484e3031f9">PIN_C</a></div><div class="ttdeci">#define PIN_C</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00023">fsm_rfid.c:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad065142efd1af84e099b32e5c1d5b74e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad065142efd1af84e099b32e5c1d5b74e">&#9670;&nbsp;</a></span>ConfiguraTarjeta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ConfiguraTarjeta </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configura la tarjeta en la base de datos Muestra un menu por pantalla e inicializa las interrupciones del, encoder para que funcionen solamente en este punto del programa. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td>Maquina de estados </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00342">342</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;{</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    printf(<span class="stringliteral">&quot;DATA -&gt; PLAY \n&quot;</span>);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    printf(<span class="stringliteral">&quot;Configuracion de Tarjeta \n&quot;</span>);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">//Inicializa las interrupciones del Encoder</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="_interrupt_s_m_8c.html#af169ed2cb7b858f9c2e7eeeee874f033">attachIsr</a>(<a class="code" href="fsm__rfid_8c.html#ad7c0c16486a5a3e1579cc8e384d7f96a">PIN_A</a>, <a class="code" href="_interrupt_s_m_8h.html#a3b65133bb9997cd1ccf311af0927fc9eaada6cf2b086af8fd5f84e946d2bd145d">CHANGE</a>, NULL, <a class="code" href="fsm__rfid_8c.html#a913e96d4f89df237a1250877f82291c7">ISR</a>);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="_interrupt_s_m_8c.html#af169ed2cb7b858f9c2e7eeeee874f033">attachIsr</a>(<a class="code" href="fsm__rfid_8c.html#a9fda21ec50fc75d0fa9bbcb33bf560ff">PIN_B</a>, <a class="code" href="_interrupt_s_m_8h.html#a3b65133bb9997cd1ccf311af0927fc9eaada6cf2b086af8fd5f84e946d2bd145d">CHANGE</a>, NULL, <a class="code" href="fsm__rfid_8c.html#a913e96d4f89df237a1250877f82291c7">ISR</a>);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="_interrupt_s_m_8c.html#af169ed2cb7b858f9c2e7eeeee874f033">attachIsr</a>(<a class="code" href="fsm__rfid_8c.html#ac31844038a274a4cfa6375484e3031f9">PIN_C</a>, <a class="code" href="_interrupt_s_m_8h.html#a3b65133bb9997cd1ccf311af0927fc9eaad4144f5191f08b249b3f4dcce4cf9e3">FALLIN_EDGE</a>, NULL, <a class="code" href="fsm__rfid_8c.html#a7d4c8489d18eb87542e04359532017f2">select_mode</a>);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">//Imprime la captura inicial</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    menu_lcd_display(<span class="stringliteral">&quot;NOT CONFIGURED!&quot;</span>, <span class="stringliteral">&quot;turn to &quot;</span>, <span class="stringliteral">&quot;configure&quot;</span>, <span class="stringliteral">&quot;:D&quot;</span>);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a> = 0;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">//Cargo lista de archivos del directorio con la musica</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="structlist__files.html">list_files_t</a> *lista = <a class="code" href="fsm__rfid_8c.html#a1988eab9789e5d3a43e9da8ab6efe4cf">get_list_files</a>(<span class="stringliteral">&quot;./musica&quot;</span>);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">//Bloqueo ejecucion hasta que se mueva el encoder una vez</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">while</span> (!(<a class="code" href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a> &amp; <a class="code" href="tipos_8h.html#a631e1e6829ddf66f6ec53f6ab5fc2554">FLAG_IRQ_STEPPER_CONTINUE</a>))</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        ;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">//Limpio los flags</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(7);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a> = 0;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(7);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">//Muentra la lista por pantalla</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="fsm__rfid_8c.html#ab4fd7a06a67d4e3d914a6293dee6b661">menu_display_stepper_plus</a>(lista);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">//Bloque ejecucion hasta que  no hay una pulsacion</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">while</span> (!(<a class="code" href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a> &amp; <a class="code" href="tipos_8h.html#a134bddded9af8032a0493fb55a84d41e">FLAG_IRQ_STEPPER_SELECT</a>))</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(7);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="comment">//Si detecto movimiento del encoder</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a> &amp; <a class="code" href="tipos_8h.html#a631e1e6829ddf66f6ec53f6ab5fc2554">FLAG_IRQ_STEPPER_CONTINUE</a>)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            lista-&gt;<a class="code" href="structlist__files.html#ab8e9545f9cf8e60731a881b07d37a134">select_file</a>++;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <span class="keywordflow">if</span> (lista-&gt;<a class="code" href="structlist__files.html#ab8e9545f9cf8e60731a881b07d37a134">select_file</a> &gt; lista-&gt;<a class="code" href="structlist__files.html#a70fbdb4ac81ecb8a257691170b40f4bb">num_files</a>)</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                lista-&gt;<a class="code" href="structlist__files.html#ab8e9545f9cf8e60731a881b07d37a134">select_file</a> = 1;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="comment">//Refresco el display</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <a class="code" href="fsm__rfid_8c.html#ab4fd7a06a67d4e3d914a6293dee6b661">menu_display_stepper_plus</a>(lista);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <a class="code" href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a> &amp;= ~<a class="code" href="tipos_8h.html#a631e1e6829ddf66f6ec53f6ab5fc2554">FLAG_IRQ_STEPPER_CONTINUE</a>;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            printf(<span class="stringliteral">&quot;Fichero %d&quot;</span>, lista-&gt;<a class="code" href="structlist__files.html#ab8e9545f9cf8e60731a881b07d37a134">select_file</a>);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            fflush(stdout);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(7);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">//Cargo base de datos y printeo pantalla final</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    sqlite3 *db = <a class="code" href="dbcontroller_8c.html#a6c03e23326b03a2084159378345e6fcf">db_load</a>(<a class="code" href="fsm__rfid_8c.html#ab840d057a03e1da1ef1b7e6d63a92d75">DB_NAME</a>);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">//Inserto en la db</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="dbcontroller_8c.html#a8954e818fd457eb22674fcf86b086f6a">db_insert</a>(db, <a class="code" href="fsm__rfid_8c.html#a2a7d69d31f9de9f46f7708405862da52">UUID_2_int</a>(), lista-&gt;<a class="code" href="structlist__files.html#ac683a830b7c1fd9d1fdee795b2b5e8a0">name_file</a>[lista-&gt;<a class="code" href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">current_file</a> - 1]);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="fsm__rfid_8c.html#a2d41eb10204306890ce82365621c19bd">ConfiguracionCorrecta</a>();</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <a class="code" href="dbcontroller_8c.html#ae07af262c608d2e3de291268d923d24a">db_close</a>(db);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}</div><div class="ttc" id="fsm__rfid_8c_html_a2d41eb10204306890ce82365621c19bd"><div class="ttname"><a href="fsm__rfid_8c.html#a2d41eb10204306890ce82365621c19bd">ConfiguracionCorrecta</a></div><div class="ttdeci">void ConfiguracionCorrecta()</div><div class="ttdoc">Desinicializacion tras la configuracion de una tarjeta Elimina todas las interrupciones asociadas al ...</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00399">fsm_rfid.c:399</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_ab4fd7a06a67d4e3d914a6293dee6b661"><div class="ttname"><a href="fsm__rfid_8c.html#ab4fd7a06a67d4e3d914a6293dee6b661">menu_display_stepper_plus</a></div><div class="ttdeci">void menu_display_stepper_plus(list_files_t *lista)</div><div class="ttdoc">Refresco del LCD con los parametros de la lista Funcion de manejo del menu que se actualiza en funcio...</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00425">fsm_rfid.c:425</a></div></div>
<div class="ttc" id="mutex_8c_html_aa5fdb07cba530aae1495d95be367d04a"><div class="ttname"><a href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a></div><div class="ttdeci">void unlock(int key)</div><div class="ttdoc">desloquea el hilo actual </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00025">mutex.c:25</a></div></div>
<div class="ttc" id="structlist__files_html_ac683a830b7c1fd9d1fdee795b2b5e8a0"><div class="ttname"><a href="structlist__files.html#ac683a830b7c1fd9d1fdee795b2b5e8a0">list_files::name_file</a></div><div class="ttdeci">char ** name_file</div><div class="ttdoc">Lista de Strings. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00027">fsm_rfid.h:27</a></div></div>
<div class="ttc" id="structlist__files_html_a5ab6e21d40127aa921eca974d3573254"><div class="ttname"><a href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">list_files::current_file</a></div><div class="ttdeci">int current_file</div><div class="ttdoc">Puntero fichero muestra. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00025">fsm_rfid.h:25</a></div></div>
<div class="ttc" id="mutex_8c_html_ad649ab53814d18a30bb40d7242961e23"><div class="ttname"><a href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a></div><div class="ttdeci">void lock(int key)</div><div class="ttdoc">Bloquea el hilo actual. </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00016">mutex.c:16</a></div></div>
<div class="ttc" id="tipos_8h_html_adbd4507c3dcdd7bd3aafd49ad3aba4cd"><div class="ttname"><a href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a></div><div class="ttdeci">volatile uint8_t stepper_irq_flag</div><div class="ttdoc">flags del encoder </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00042">tipos.h:42</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a9fda21ec50fc75d0fa9bbcb33bf560ff"><div class="ttname"><a href="fsm__rfid_8c.html#a9fda21ec50fc75d0fa9bbcb33bf560ff">PIN_B</a></div><div class="ttdeci">#define PIN_B</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00022">fsm_rfid.c:22</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a913e96d4f89df237a1250877f82291c7"><div class="ttname"><a href="fsm__rfid_8c.html#a913e96d4f89df237a1250877f82291c7">ISR</a></div><div class="ttdeci">void ISR(int event)</div><div class="ttdoc">Registra las interrupciones del Encoder. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00594">fsm_rfid.c:594</a></div></div>
<div class="ttc" id="dbcontroller_8c_html_ae07af262c608d2e3de291268d923d24a"><div class="ttname"><a href="dbcontroller_8c.html#ae07af262c608d2e3de291268d923d24a">db_close</a></div><div class="ttdeci">void db_close(sqlite3 *db)</div><div class="ttdoc">Cierra la base de datos y libera la memoria asignada al puntero. </div><div class="ttdef"><b>Definition:</b> <a href="dbcontroller_8c_source.html#l00203">dbcontroller.c:203</a></div></div>
<div class="ttc" id="dbcontroller_8c_html_a8954e818fd457eb22674fcf86b086f6a"><div class="ttname"><a href="dbcontroller_8c.html#a8954e818fd457eb22674fcf86b086f6a">db_insert</a></div><div class="ttdeci">int db_insert(sqlite3 *db, int user_id, char *song_name)</div><div class="ttdoc">Ejecuta la query para insertar en la base de datos. </div><div class="ttdef"><b>Definition:</b> <a href="dbcontroller_8c_source.html#l00129">dbcontroller.c:129</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a2a7d69d31f9de9f46f7708405862da52"><div class="ttname"><a href="fsm__rfid_8c.html#a2a7d69d31f9de9f46f7708405862da52">UUID_2_int</a></div><div class="ttdeci">int UUID_2_int()</div><div class="ttdoc">Conversor de Int Array a int del UUID. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00570">fsm_rfid.c:570</a></div></div>
<div class="ttc" id="tipos_8h_html_a631e1e6829ddf66f6ec53f6ab5fc2554"><div class="ttname"><a href="tipos_8h.html#a631e1e6829ddf66f6ec53f6ab5fc2554">FLAG_IRQ_STEPPER_CONTINUE</a></div><div class="ttdeci">#define FLAG_IRQ_STEPPER_CONTINUE</div><div class="ttdoc">Flag de movimiento detectado. </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00035">tipos.h:35</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a1988eab9789e5d3a43e9da8ab6efe4cf"><div class="ttname"><a href="fsm__rfid_8c.html#a1988eab9789e5d3a43e9da8ab6efe4cf">get_list_files</a></div><div class="ttdeci">list_files_t * get_list_files(char *route)</div><div class="ttdoc">Crea una estrucutura de tipo lista en el directorio pasado como parametro Reserva memoria para una es...</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00447">fsm_rfid.c:447</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_ab840d057a03e1da1ef1b7e6d63a92d75"><div class="ttname"><a href="fsm__rfid_8c.html#ab840d057a03e1da1ef1b7e6d63a92d75">DB_NAME</a></div><div class="ttdeci">#define DB_NAME</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00020">fsm_rfid.c:20</a></div></div>
<div class="ttc" id="structlist__files_html"><div class="ttname"><a href="structlist__files.html">list_files</a></div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00023">fsm_rfid.h:23</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_ad7c0c16486a5a3e1579cc8e384d7f96a"><div class="ttname"><a href="fsm__rfid_8c.html#ad7c0c16486a5a3e1579cc8e384d7f96a">PIN_A</a></div><div class="ttdeci">#define PIN_A</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00021">fsm_rfid.c:21</a></div></div>
<div class="ttc" id="_interrupt_s_m_8c_html_af169ed2cb7b858f9c2e7eeeee874f033"><div class="ttname"><a href="_interrupt_s_m_8c.html#af169ed2cb7b858f9c2e7eeeee874f033">attachIsr</a></div><div class="ttdeci">void attachIsr(uint8_t PIN, uint8_t ISREvent, void *handdle, void *userData)</div><div class="ttdoc">Crea la interrupcion Crea un hilo donde se lanza una funcion que analizara el estado del pin para det...</div><div class="ttdef"><b>Definition:</b> <a href="_interrupt_s_m_8c_source.html#l00062">InterruptSM.c:62</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_ac31844038a274a4cfa6375484e3031f9"><div class="ttname"><a href="fsm__rfid_8c.html#ac31844038a274a4cfa6375484e3031f9">PIN_C</a></div><div class="ttdeci">#define PIN_C</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00023">fsm_rfid.c:23</a></div></div>
<div class="ttc" id="structlist__files_html_a70fbdb4ac81ecb8a257691170b40f4bb"><div class="ttname"><a href="structlist__files.html#a70fbdb4ac81ecb8a257691170b40f4bb">list_files::num_files</a></div><div class="ttdeci">int num_files</div><div class="ttdoc">Numero de ficheros totales. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00024">fsm_rfid.h:24</a></div></div>
<div class="ttc" id="dbcontroller_8c_html_a6c03e23326b03a2084159378345e6fcf"><div class="ttname"><a href="dbcontroller_8c.html#a6c03e23326b03a2084159378345e6fcf">db_load</a></div><div class="ttdeci">sqlite3 * db_load(char *file_dir)</div><div class="ttdef"><b>Definition:</b> <a href="dbcontroller_8c_source.html#l00042">dbcontroller.c:42</a></div></div>
<div class="ttc" id="_interrupt_s_m_8h_html_a3b65133bb9997cd1ccf311af0927fc9eaada6cf2b086af8fd5f84e946d2bd145d"><div class="ttname"><a href="_interrupt_s_m_8h.html#a3b65133bb9997cd1ccf311af0927fc9eaada6cf2b086af8fd5f84e946d2bd145d">CHANGE</a></div><div class="ttdoc">Cambio de nivel. </div><div class="ttdef"><b>Definition:</b> <a href="_interrupt_s_m_8h_source.html#l00037">InterruptSM.h:37</a></div></div>
<div class="ttc" id="_interrupt_s_m_8h_html_a3b65133bb9997cd1ccf311af0927fc9eaad4144f5191f08b249b3f4dcce4cf9e3"><div class="ttname"><a href="_interrupt_s_m_8h.html#a3b65133bb9997cd1ccf311af0927fc9eaad4144f5191f08b249b3f4dcce4cf9e3">FALLIN_EDGE</a></div><div class="ttdoc">Flanco de bajada. </div><div class="ttdef"><b>Definition:</b> <a href="_interrupt_s_m_8h_source.html#l00033">InterruptSM.h:33</a></div></div>
<div class="ttc" id="tipos_8h_html_a134bddded9af8032a0493fb55a84d41e"><div class="ttname"><a href="tipos_8h.html#a134bddded9af8032a0493fb55a84d41e">FLAG_IRQ_STEPPER_SELECT</a></div><div class="ttdeci">#define FLAG_IRQ_STEPPER_SELECT</div><div class="ttdoc">Flag de pulsacion de selecion detectado. </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00036">tipos.h:36</a></div></div>
<div class="ttc" id="structlist__files_html_ab8e9545f9cf8e60731a881b07d37a134"><div class="ttname"><a href="structlist__files.html#ab8e9545f9cf8e60731a881b07d37a134">list_files::select_file</a></div><div class="ttdeci">int select_file</div><div class="ttdoc">Puntero fichero Seleccionado. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00026">fsm_rfid.h:26</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a7d4c8489d18eb87542e04359532017f2"><div class="ttname"><a href="fsm__rfid_8c.html#a7d4c8489d18eb87542e04359532017f2">select_mode</a></div><div class="ttdeci">void select_mode(int event)</div><div class="ttdoc">Callback de boton del encoder Activa el flag de seleccion del encoder. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00630">fsm_rfid.c:630</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f0ba74b305da68c1f2969dd64042d8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f0ba74b305da68c1f2969dd64042d8b">&#9670;&nbsp;</a></span>DescartaTarjeta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DescartaTarjeta </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Altera el flag de tarjeta insertada. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td>Maquina de estados </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00186">186</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;{</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(0);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a> &amp;= ~<a class="code" href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaaff96c427210e75a502d2083d839844bb">FLAG_CARD_IN</a>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(0);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div><div class="ttc" id="mutex_8c_html_aa5fdb07cba530aae1495d95be367d04a"><div class="ttname"><a href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a></div><div class="ttdeci">void unlock(int key)</div><div class="ttdoc">desloquea el hilo actual </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00025">mutex.c:25</a></div></div>
<div class="ttc" id="fsm__rfid_8h_html_abdc0ff505cbd4c3a6fc0eee64ca2ddcaaff96c427210e75a502d2083d839844bb"><div class="ttname"><a href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaaff96c427210e75a502d2083d839844bb">FLAG_CARD_IN</a></div><div class="ttdoc">Flag de tarjeta detectada optoacoplador. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00032">fsm_rfid.h:32</a></div></div>
<div class="ttc" id="mutex_8c_html_ad649ab53814d18a30bb40d7242961e23"><div class="ttname"><a href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a></div><div class="ttdeci">void lock(int key)</div><div class="ttdoc">Bloquea el hilo actual. </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00016">mutex.c:16</a></div></div>
<div class="ttc" id="tipos_8h_html_a23e04a79e83a0bb62dc3d6be4e0d1b92"><div class="ttname"><a href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a></div><div class="ttdeci">volatile uint8_t flag_rfid</div><div class="ttdoc">flags del rfid </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00041">tipos.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2bf6bef8226a73e69999b66ab1c4d1ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bf6bef8226a73e69999b66ab1c4d1ce">&#9670;&nbsp;</a></span>EsperaTargeta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EsperaTargeta </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Funcion de espera de la tarjeta mientras no haya una en el optoacoplador. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td>Maquina de estados </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00177">177</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;{</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="ad61e8abe347c0fe4e1fa343f2a3dde2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad61e8abe347c0fe4e1fa343f2a3dde2f">&#9670;&nbsp;</a></span>FinalizaReproduccion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FinalizaReproduccion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Funcion de finalizacion de reproduccion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td>Maquina de estados </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00245">245</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;{</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(1);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="tipos_8h.html#a8d6cbadfb1878d67dffef9647ba5fe05">flags_player</a> |= <a class="code" href="tipos_8h.html#abe8b7d04534b17feedbf65d3d40a28ef">FLAG_END</a>;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(1);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;}</div><div class="ttc" id="tipos_8h_html_a8d6cbadfb1878d67dffef9647ba5fe05"><div class="ttname"><a href="tipos_8h.html#a8d6cbadfb1878d67dffef9647ba5fe05">flags_player</a></div><div class="ttdeci">volatile uint8_t flags_player</div><div class="ttdoc">flags del player </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00040">tipos.h:40</a></div></div>
<div class="ttc" id="mutex_8c_html_aa5fdb07cba530aae1495d95be367d04a"><div class="ttname"><a href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a></div><div class="ttdeci">void unlock(int key)</div><div class="ttdoc">desloquea el hilo actual </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00025">mutex.c:25</a></div></div>
<div class="ttc" id="mutex_8c_html_ad649ab53814d18a30bb40d7242961e23"><div class="ttname"><a href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a></div><div class="ttdeci">void lock(int key)</div><div class="ttdoc">Bloquea el hilo actual. </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00016">mutex.c:16</a></div></div>
<div class="ttc" id="tipos_8h_html_abe8b7d04534b17feedbf65d3d40a28ef"><div class="ttname"><a href="tipos_8h.html#abe8b7d04534b17feedbf65d3d40a28ef">FLAG_END</a></div><div class="ttdeci">#define FLAG_END</div><div class="ttdoc">Flag fin de cancion. </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00031">tipos.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e5e6e0d90b0435a4ce38504eccf243a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e5e6e0d90b0435a4ce38504eccf243a">&#9670;&nbsp;</a></span>get_last_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* get_last_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm__rfid_8h.html#a85839a66c9eb826246b8cd0b5652c26f">list_files_t</a> *&#160;</td>
          <td class="paramname"><em>lista</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Se mueve una posicion hacia atrás el punero de fichero actual. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lista</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>char* </dd></dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00502">502</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;{</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">return</span> lista-&gt;<a class="code" href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">current_file</a> &gt;= 0 ? lista-&gt;<a class="code" href="structlist__files.html#ac683a830b7c1fd9d1fdee795b2b5e8a0">name_file</a>[lista-&gt;<a class="code" href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">current_file</a>--] : NULL;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;}</div><div class="ttc" id="structlist__files_html_ac683a830b7c1fd9d1fdee795b2b5e8a0"><div class="ttname"><a href="structlist__files.html#ac683a830b7c1fd9d1fdee795b2b5e8a0">list_files::name_file</a></div><div class="ttdeci">char ** name_file</div><div class="ttdoc">Lista de Strings. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00027">fsm_rfid.h:27</a></div></div>
<div class="ttc" id="structlist__files_html_a5ab6e21d40127aa921eca974d3573254"><div class="ttname"><a href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">list_files::current_file</a></div><div class="ttdeci">int current_file</div><div class="ttdoc">Puntero fichero muestra. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00025">fsm_rfid.h:25</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1988eab9789e5d3a43e9da8ab6efe4cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1988eab9789e5d3a43e9da8ab6efe4cf">&#9670;&nbsp;</a></span>get_list_files()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fsm__rfid_8h.html#a85839a66c9eb826246b8cd0b5652c26f">list_files_t</a> * get_list_files </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>route</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Crea una estrucutura de tipo lista en el directorio pasado como parametro Reserva memoria para una estructura de tipo lista de ficheros y la rellena con los datos del directorio que se esta escaneando. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">route</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>list_files_t* </dd></dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00447">447</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;{</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    DIR *dir;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keyword">struct </span>dirent *ent;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="structlist__files.html">list_files_t</a> *lista;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">//Inicializo la estructuar de datos</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordtype">int</span> num_files = <a class="code" href="fsm__rfid_8c.html#afe523c2456ee5991ac24ccaef49a56c8">get_number_files</a>(route);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    printf(<span class="stringliteral">&quot;nfiles = %d \n&quot;</span>, num_files);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    lista = <a class="code" href="fsm__rfid_8c.html#a087470326fb60619195e0bc275a83191">new_list_files</a>(num_files);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">//Abro el directorio de la ruta</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> ((dir = opendir(route)) != NULL)</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="comment">//Se ejecuta mientras haya algun fichero no leido</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">while</span> ((ent = readdir(dir)) != NULL)</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            <span class="comment">//Si es un tipo regular, fichero valido, lo añado a la lista</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <span class="keywordflow">if</span> (ent-&gt;d_type == DT_REG)</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                printf(<span class="stringliteral">&quot;%s\n&quot;</span>, ent-&gt;d_name);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                strcpy(lista-&gt;<a class="code" href="structlist__files.html#ac683a830b7c1fd9d1fdee795b2b5e8a0">name_file</a>[i++], ent-&gt;d_name);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            }</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="comment">//Cierro el directorio</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        closedir(dir);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    {</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        printf(<span class="stringliteral">&quot;Error no se puede abrir el directorio&quot;</span>);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    printf(<span class="stringliteral">&quot;all ok \n&quot;</span>);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">return</span> lista;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;}</div><div class="ttc" id="structlist__files_html_ac683a830b7c1fd9d1fdee795b2b5e8a0"><div class="ttname"><a href="structlist__files.html#ac683a830b7c1fd9d1fdee795b2b5e8a0">list_files::name_file</a></div><div class="ttdeci">char ** name_file</div><div class="ttdoc">Lista de Strings. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00027">fsm_rfid.h:27</a></div></div>
<div class="ttc" id="structlist__files_html"><div class="ttname"><a href="structlist__files.html">list_files</a></div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00023">fsm_rfid.h:23</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a087470326fb60619195e0bc275a83191"><div class="ttname"><a href="fsm__rfid_8c.html#a087470326fb60619195e0bc275a83191">new_list_files</a></div><div class="ttdeci">list_files_t * new_list_files(int num_files)</div><div class="ttdoc">Devuelve una estructura con memoria reservada y parametros por defecto. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00536">fsm_rfid.c:536</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_afe523c2456ee5991ac24ccaef49a56c8"><div class="ttname"><a href="fsm__rfid_8c.html#afe523c2456ee5991ac24ccaef49a56c8">get_number_files</a></div><div class="ttdeci">int get_number_files(char *route)</div><div class="ttdoc">Cuenta el numero de ficheros que hay en la ruta. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00513">fsm_rfid.c:513</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5fb305adea1f2ff378f4560e1445bce2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fb305adea1f2ff378f4560e1445bce2">&#9670;&nbsp;</a></span>get_next_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * get_next_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm__rfid_8h.html#a85839a66c9eb826246b8cd0b5652c26f">list_files_t</a> *&#160;</td>
          <td class="paramname"><em>lista</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Se mueve una posicion hacia delante el punero de fichero actual. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lista</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>char* </dd></dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00487">487</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;{</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">if</span> (lista-&gt;<a class="code" href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">current_file</a> &gt;= lista-&gt;<a class="code" href="structlist__files.html#a70fbdb4ac81ecb8a257691170b40f4bb">num_files</a> || lista-&gt;<a class="code" href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">current_file</a> &lt; 0)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        lista-&gt;<a class="code" href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">current_file</a> = 0;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    printf(<span class="stringliteral">&quot;current pos: %d \n&quot;</span>, lista-&gt;<a class="code" href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">current_file</a>);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">return</span> lista-&gt;<a class="code" href="structlist__files.html#ac683a830b7c1fd9d1fdee795b2b5e8a0">name_file</a>[lista-&gt;<a class="code" href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">current_file</a>++];</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;}</div><div class="ttc" id="structlist__files_html_ac683a830b7c1fd9d1fdee795b2b5e8a0"><div class="ttname"><a href="structlist__files.html#ac683a830b7c1fd9d1fdee795b2b5e8a0">list_files::name_file</a></div><div class="ttdeci">char ** name_file</div><div class="ttdoc">Lista de Strings. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00027">fsm_rfid.h:27</a></div></div>
<div class="ttc" id="structlist__files_html_a5ab6e21d40127aa921eca974d3573254"><div class="ttname"><a href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">list_files::current_file</a></div><div class="ttdeci">int current_file</div><div class="ttdoc">Puntero fichero muestra. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00025">fsm_rfid.h:25</a></div></div>
<div class="ttc" id="structlist__files_html_a70fbdb4ac81ecb8a257691170b40f4bb"><div class="ttname"><a href="structlist__files.html#a70fbdb4ac81ecb8a257691170b40f4bb">list_files::num_files</a></div><div class="ttdeci">int num_files</div><div class="ttdoc">Numero de ficheros totales. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00024">fsm_rfid.h:24</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afe523c2456ee5991ac24ccaef49a56c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe523c2456ee5991ac24ccaef49a56c8">&#9670;&nbsp;</a></span>get_number_files()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_number_files </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>route</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cuenta el numero de ficheros que hay en la ruta. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">route</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00513">513</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;{</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordtype">int</span> file_count = 0;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    DIR *dirp;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keyword">struct </span>dirent *entry;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    dirp = opendir(route); <span class="comment">/* There should be error handling after this */</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">while</span> ((entry = readdir(dirp)) != NULL)</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    {</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">if</span> (entry-&gt;d_type == DT_REG)</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        { <span class="comment">/* If the entry is a regular file */</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            file_count++;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        }</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    closedir(dirp);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">return</span> file_count;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a913e96d4f89df237a1250877f82291c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a913e96d4f89df237a1250877f82291c7">&#9670;&nbsp;</a></span>ISR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ISR </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registra las interrupciones del Encoder. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">event</td><td>evento que se ha producido </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00594">594</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;{</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">//Muestreamos ambos canales</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordtype">int</span> A_val = bcm2835_gpio_lev(<a class="code" href="fsm__rfid_8c.html#ad7c0c16486a5a3e1579cc8e384d7f96a">PIN_A</a>);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordtype">int</span> B_val = bcm2835_gpio_lev(<a class="code" href="fsm__rfid_8c.html#a9fda21ec50fc75d0fa9bbcb33bf560ff">PIN_B</a>);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="comment">//Almaceno los valores muestreados</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="fsm__rfid_8c.html#aefd9aadc5bca10986d4506c0b045be65">seqA</a> &lt;&lt;= 1;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <a class="code" href="fsm__rfid_8c.html#aefd9aadc5bca10986d4506c0b045be65">seqA</a> |= A_val;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <a class="code" href="fsm__rfid_8c.html#a7f153a44052f2c810d14272facac0f82">seqB</a> &lt;&lt;= 1;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="fsm__rfid_8c.html#a7f153a44052f2c810d14272facac0f82">seqB</a> |= B_val;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">//Enmascaro los valores</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="fsm__rfid_8c.html#aefd9aadc5bca10986d4506c0b045be65">seqA</a> &amp;= 0b00001111;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="fsm__rfid_8c.html#a7f153a44052f2c810d14272facac0f82">seqB</a> &amp;= 0b00001111;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">//Compruebo si la secuencia coincide con las de un giro a derecha</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="fsm__rfid_8c.html#aefd9aadc5bca10986d4506c0b045be65">seqA</a> == 0b00001001 &amp;&amp; <a class="code" href="fsm__rfid_8c.html#a7f153a44052f2c810d14272facac0f82">seqB</a> == 0b00000011)</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <a class="code" href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a> |= <a class="code" href="tipos_8h.html#a631e1e6829ddf66f6ec53f6ab5fc2554">FLAG_IRQ_STEPPER_CONTINUE</a>;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <a class="code" href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a> |= <a class="code" href="tipos_8h.html#a45c907a60e8bc57bc7228754eae71b25">FLAG_IRQ_STEPPER_DIR</a>;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        printf(<span class="stringliteral">&quot;He girado \n&quot;</span>);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        fflush(stdout);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">//Compruebo si la secuencia coincide con las de un giro a izquierda</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="fsm__rfid_8c.html#aefd9aadc5bca10986d4506c0b045be65">seqA</a> == 0b00000011 &amp;&amp; <a class="code" href="fsm__rfid_8c.html#a7f153a44052f2c810d14272facac0f82">seqB</a> == 0b00001001)</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    {</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <a class="code" href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a> |= <a class="code" href="tipos_8h.html#a631e1e6829ddf66f6ec53f6ab5fc2554">FLAG_IRQ_STEPPER_CONTINUE</a>;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <a class="code" href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a> &amp;= ~<a class="code" href="tipos_8h.html#a45c907a60e8bc57bc7228754eae71b25">FLAG_IRQ_STEPPER_DIR</a>;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        printf(<span class="stringliteral">&quot;He girado \n&quot;</span>);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        fflush(stdout);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;}</div><div class="ttc" id="fsm__rfid_8c_html_aefd9aadc5bca10986d4506c0b045be65"><div class="ttname"><a href="fsm__rfid_8c.html#aefd9aadc5bca10986d4506c0b045be65">seqA</a></div><div class="ttdeci">int seqA</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00586">fsm_rfid.c:586</a></div></div>
<div class="ttc" id="tipos_8h_html_adbd4507c3dcdd7bd3aafd49ad3aba4cd"><div class="ttname"><a href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a></div><div class="ttdeci">volatile uint8_t stepper_irq_flag</div><div class="ttdoc">flags del encoder </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00042">tipos.h:42</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a9fda21ec50fc75d0fa9bbcb33bf560ff"><div class="ttname"><a href="fsm__rfid_8c.html#a9fda21ec50fc75d0fa9bbcb33bf560ff">PIN_B</a></div><div class="ttdeci">#define PIN_B</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00022">fsm_rfid.c:22</a></div></div>
<div class="ttc" id="tipos_8h_html_a631e1e6829ddf66f6ec53f6ab5fc2554"><div class="ttname"><a href="tipos_8h.html#a631e1e6829ddf66f6ec53f6ab5fc2554">FLAG_IRQ_STEPPER_CONTINUE</a></div><div class="ttdeci">#define FLAG_IRQ_STEPPER_CONTINUE</div><div class="ttdoc">Flag de movimiento detectado. </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00035">tipos.h:35</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_ad7c0c16486a5a3e1579cc8e384d7f96a"><div class="ttname"><a href="fsm__rfid_8c.html#ad7c0c16486a5a3e1579cc8e384d7f96a">PIN_A</a></div><div class="ttdeci">#define PIN_A</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00021">fsm_rfid.c:21</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a7f153a44052f2c810d14272facac0f82"><div class="ttname"><a href="fsm__rfid_8c.html#a7f153a44052f2c810d14272facac0f82">seqB</a></div><div class="ttdeci">int seqB</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00587">fsm_rfid.c:587</a></div></div>
<div class="ttc" id="tipos_8h_html_a45c907a60e8bc57bc7228754eae71b25"><div class="ttname"><a href="tipos_8h.html#a45c907a60e8bc57bc7228754eae71b25">FLAG_IRQ_STEPPER_DIR</a></div><div class="ttdeci">#define FLAG_IRQ_STEPPER_DIR</div><div class="ttdoc">Flag de direccion de movimiento 0-&gt; izq 1-&gt; der. </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00037">tipos.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a822642377d33813dcd95207d8a339282"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a822642377d33813dcd95207d8a339282">&#9670;&nbsp;</a></span>killRFID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void killRFID </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mata la maquina de estados del rfid. </p>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00412">412</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;{</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    pthread_cancel(<a class="code" href="fsm__rfid_8h.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <a class="code" href="fsm__rfid_8c.html#adc76c8cbae64e5426e49144ac52ac6d5">maquina_creada</a> = 0;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;}</div><div class="ttc" id="fsm__rfid_8h_html_a01f75a9ad916f63a94e06a27635ba278"><div class="ttname"><a href="fsm__rfid_8h.html#a01f75a9ad916f63a94e06a27635ba278">thread</a></div><div class="ttdeci">pthread_t thread</div><div class="ttdoc">Hilo de ejecucion de la maquina de estados. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00048">fsm_rfid.h:48</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_adc76c8cbae64e5426e49144ac52ac6d5"><div class="ttname"><a href="fsm__rfid_8c.html#adc76c8cbae64e5426e49144ac52ac6d5">maquina_creada</a></div><div class="ttdeci">int maquina_creada</div><div class="ttdoc">Indica si la maquina de estados ha sido creada ya o no. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00032">fsm_rfid.c:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa239886bea26a31d0f6ddf5137a804cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa239886bea26a31d0f6ddf5137a804cb">&#9670;&nbsp;</a></span>launchRFID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void launchRFID </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Funcion de creacion de la maquina de estados Si la maquina de estados ya esta creada no se crea otra. </p>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00287">287</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;{</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="fsm__rfid_8c.html#adc76c8cbae64e5426e49144ac52ac6d5">maquina_creada</a>)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        printf(<span class="stringliteral">&quot;La maquina de estados ya ha sido creada \n&quot;</span>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        fflush(stdout);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="fsm__rfid_8h.html#a4172cd6a98793577c1c4f3389b134791">fsm_rfid</a> = <a class="code" href="fsm_8c.html#a5a5f1422455f99b9d1c2d74d04537de7">fsm_new</a>(<a class="code" href="fsm__rfid_8c.html#a1b63db81023235b2ef3108ad324a58f8">transition_table_rfid</a>, NULL);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    pthread_create(&amp;<a class="code" href="fsm__rfid_8h.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>, NULL, <a class="code" href="fsm__rfid_8c.html#a1ad6b3a023f7f39cfc2d607f2c26dd9b">lp</a>, <a class="code" href="fsm__rfid_8h.html#a4172cd6a98793577c1c4f3389b134791">fsm_rfid</a>);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="fsm__rfid_8c.html#adc76c8cbae64e5426e49144ac52ac6d5">maquina_creada</a> = 1;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;}</div><div class="ttc" id="fsm__rfid_8c_html_a1ad6b3a023f7f39cfc2d607f2c26dd9b"><div class="ttname"><a href="fsm__rfid_8c.html#a1ad6b3a023f7f39cfc2d607f2c26dd9b">lp</a></div><div class="ttdeci">void lp(void *userData)</div><div class="ttdoc">Funcion de loop infinito de la maquina de estados. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00275">fsm_rfid.c:275</a></div></div>
<div class="ttc" id="fsm_8c_html_a5a5f1422455f99b9d1c2d74d04537de7"><div class="ttname"><a href="fsm_8c.html#a5a5f1422455f99b9d1c2d74d04537de7">fsm_new</a></div><div class="ttdeci">fsm_t * fsm_new(fsm_trans_t *tt, void *user_data)</div><div class="ttdef"><b>Definition:</b> <a href="fsm_8c_source.html#l00010">fsm.c:10</a></div></div>
<div class="ttc" id="fsm__rfid_8h_html_a01f75a9ad916f63a94e06a27635ba278"><div class="ttname"><a href="fsm__rfid_8h.html#a01f75a9ad916f63a94e06a27635ba278">thread</a></div><div class="ttdeci">pthread_t thread</div><div class="ttdoc">Hilo de ejecucion de la maquina de estados. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00048">fsm_rfid.h:48</a></div></div>
<div class="ttc" id="fsm__rfid_8h_html_a4172cd6a98793577c1c4f3389b134791"><div class="ttname"><a href="fsm__rfid_8h.html#a4172cd6a98793577c1c4f3389b134791">fsm_rfid</a></div><div class="ttdeci">fsm_t * fsm_rfid</div><div class="ttdoc">Puntero fsm de la maquina de estados. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00047">fsm_rfid.h:47</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a1b63db81023235b2ef3108ad324a58f8"><div class="ttname"><a href="fsm__rfid_8c.html#a1b63db81023235b2ef3108ad324a58f8">transition_table_rfid</a></div><div class="ttdeci">fsm_trans_t transition_table_rfid[]</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00050">fsm_rfid.c:50</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_adc76c8cbae64e5426e49144ac52ac6d5"><div class="ttname"><a href="fsm__rfid_8c.html#adc76c8cbae64e5426e49144ac52ac6d5">maquina_creada</a></div><div class="ttdeci">int maquina_creada</div><div class="ttdoc">Indica si la maquina de estados ha sido creada ya o no. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00032">fsm_rfid.c:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b8679a64ad408caa001f99dd8f4ef88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b8679a64ad408caa001f99dd8f4ef88">&#9670;&nbsp;</a></span>LeerTarjeta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LeerTarjeta </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lee la tarjeta, activa el flag de tarjeta valida Lee la tarjeta, almacena en una variable privada del fichero el UUID de la misma. Activa el flag de tarjeta valida. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td>Maquina de estados </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00198">198</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;{</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> (RC522_Check(<a class="code" href="fsm__rfid_8c.html#a414378ace9198797d96ba624749060e0">UUID</a>) == STATUS_OK)</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        printf(<span class="stringliteral">&quot;FOUND TAG! \n&quot;</span>);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        fflush(stdout);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a> |= <a class="code" href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaae5f9e2292599b01b2028179e3f056e60">FLAG_VALID_CARD</a>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div><div class="ttc" id="fsm__rfid_8c_html_a414378ace9198797d96ba624749060e0"><div class="ttname"><a href="fsm__rfid_8c.html#a414378ace9198797d96ba624749060e0">UUID</a></div><div class="ttdeci">uint8_t UUID[16]</div><div class="ttdoc">Variable privada con el UUID de la ultima tarjeta. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00028">fsm_rfid.c:28</a></div></div>
<div class="ttc" id="fsm__rfid_8h_html_abdc0ff505cbd4c3a6fc0eee64ca2ddcaae5f9e2292599b01b2028179e3f056e60"><div class="ttname"><a href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaae5f9e2292599b01b2028179e3f056e60">FLAG_VALID_CARD</a></div><div class="ttdoc">Flag tarjeta valida RFID. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00033">fsm_rfid.h:33</a></div></div>
<div class="ttc" id="tipos_8h_html_a23e04a79e83a0bb62dc3d6be4e0d1b92"><div class="ttname"><a href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a></div><div class="ttdeci">volatile uint8_t flag_rfid</div><div class="ttdoc">flags del rfid </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00041">tipos.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ad6b3a023f7f39cfc2d607f2c26dd9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ad6b3a023f7f39cfc2d607f2c26dd9b">&#9670;&nbsp;</a></span>lp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lp </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>userData</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Funcion de loop infinito de la maquina de estados. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">userData</td><td>Datos externos </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00275">275</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;{</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="structfsm__.html">fsm_t</a> *data = (<a class="code" href="structfsm__.html">fsm_t</a> *)userData;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">while</span> (1)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <a class="code" href="fsm_8c.html#ab819883cf2f1ddfab600f96057d74169">fsm_fire</a>(data);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;}</div><div class="ttc" id="fsm_8c_html_ab819883cf2f1ddfab600f96057d74169"><div class="ttname"><a href="fsm_8c.html#ab819883cf2f1ddfab600f96057d74169">fsm_fire</a></div><div class="ttdeci">void fsm_fire(fsm_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="fsm_8c_source.html#l00023">fsm.c:23</a></div></div>
<div class="ttc" id="structfsm___html"><div class="ttname"><a href="structfsm__.html">fsm_</a></div><div class="ttdef"><b>Definition:</b> <a href="fsm_8h_source.html#l00025">fsm.h:25</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab4fd7a06a67d4e3d914a6293dee6b661"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4fd7a06a67d4e3d914a6293dee6b661">&#9670;&nbsp;</a></span>menu_display_stepper_plus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void menu_display_stepper_plus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm__rfid_8h.html#a85839a66c9eb826246b8cd0b5652c26f">list_files_t</a> *&#160;</td>
          <td class="paramname"><em>lista</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refresco del LCD con los parametros de la lista Funcion de manejo del menu que se actualiza en funcion de lo que se haya operado en la funcion lista, para poder mostrar un menu rotativo bidireccional por el LCD. Anade en la primera linea del LCD el promt de seleccion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lista</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00425">425</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;{</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    menu_lcd_display_clear();</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a> &amp; <a class="code" href="tipos_8h.html#a45c907a60e8bc57bc7228754eae71b25">FLAG_IRQ_STEPPER_DIR</a>)</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        lista-&gt;<a class="code" href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">current_file</a> -= 2;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    printf(<span class="stringliteral">&quot;Posicion %d \n&quot;</span>, lista-&gt;<a class="code" href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">current_file</a>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    fflush(stdout);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordtype">char</span> line1[20] = <span class="stringliteral">&quot;&gt;&quot;</span>;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    strcat(line1, <a class="code" href="fsm__rfid_8c.html#a5fb305adea1f2ff378f4560e1445bce2">get_next_file</a>(lista));</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordtype">int</span> nextIndex = lista-&gt;<a class="code" href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">current_file</a>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    menu_lcd_display(line1, <a class="code" href="fsm__rfid_8c.html#a5fb305adea1f2ff378f4560e1445bce2">get_next_file</a>(lista), <a class="code" href="fsm__rfid_8c.html#a5fb305adea1f2ff378f4560e1445bce2">get_next_file</a>(lista), <a class="code" href="fsm__rfid_8c.html#a5fb305adea1f2ff378f4560e1445bce2">get_next_file</a>(lista));</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    lista-&gt;<a class="code" href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">current_file</a> = nextIndex;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;}</div><div class="ttc" id="structlist__files_html_a5ab6e21d40127aa921eca974d3573254"><div class="ttname"><a href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">list_files::current_file</a></div><div class="ttdeci">int current_file</div><div class="ttdoc">Puntero fichero muestra. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00025">fsm_rfid.h:25</a></div></div>
<div class="ttc" id="tipos_8h_html_adbd4507c3dcdd7bd3aafd49ad3aba4cd"><div class="ttname"><a href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a></div><div class="ttdeci">volatile uint8_t stepper_irq_flag</div><div class="ttdoc">flags del encoder </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00042">tipos.h:42</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a5fb305adea1f2ff378f4560e1445bce2"><div class="ttname"><a href="fsm__rfid_8c.html#a5fb305adea1f2ff378f4560e1445bce2">get_next_file</a></div><div class="ttdeci">char * get_next_file(list_files_t *lista)</div><div class="ttdoc">Se mueve una posicion hacia delante el punero de fichero actual. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00487">fsm_rfid.c:487</a></div></div>
<div class="ttc" id="tipos_8h_html_a45c907a60e8bc57bc7228754eae71b25"><div class="ttname"><a href="tipos_8h.html#a45c907a60e8bc57bc7228754eae71b25">FLAG_IRQ_STEPPER_DIR</a></div><div class="ttdeci">#define FLAG_IRQ_STEPPER_DIR</div><div class="ttdoc">Flag de direccion de movimiento 0-&gt; izq 1-&gt; der. </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00037">tipos.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a087470326fb60619195e0bc275a83191"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a087470326fb60619195e0bc275a83191">&#9670;&nbsp;</a></span>new_list_files()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fsm__rfid_8h.html#a85839a66c9eb826246b8cd0b5652c26f">list_files_t</a> * new_list_files </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_files</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Devuelve una estructura con memoria reservada y parametros por defecto. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num_files</td><td>numero de elementos de la lista </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>list_files_t* puntero a la lista creada </dd></dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00536">536</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;{</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="structlist__files.html">list_files_t</a> *lista = (<a class="code" href="structlist__files.html">list_files_t</a> *)malloc(<span class="keyword">sizeof</span>(<a class="code" href="structlist__files.html">list_files_t</a>));</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    lista-&gt;<a class="code" href="structlist__files.html#a70fbdb4ac81ecb8a257691170b40f4bb">num_files</a> = num_files;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    lista-&gt;<a class="code" href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">current_file</a> = 0;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    lista-&gt;<a class="code" href="structlist__files.html#ab8e9545f9cf8e60731a881b07d37a134">select_file</a> = 1;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    lista-&gt;<a class="code" href="structlist__files.html#ac683a830b7c1fd9d1fdee795b2b5e8a0">name_file</a> = (<span class="keywordtype">char</span> **)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *) * num_files);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; num_files; i++)</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        lista-&gt;<a class="code" href="structlist__files.html#ac683a830b7c1fd9d1fdee795b2b5e8a0">name_file</a>[i] = (<span class="keywordtype">char</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *) * 20);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">return</span> lista;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;}</div><div class="ttc" id="structlist__files_html_ac683a830b7c1fd9d1fdee795b2b5e8a0"><div class="ttname"><a href="structlist__files.html#ac683a830b7c1fd9d1fdee795b2b5e8a0">list_files::name_file</a></div><div class="ttdeci">char ** name_file</div><div class="ttdoc">Lista de Strings. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00027">fsm_rfid.h:27</a></div></div>
<div class="ttc" id="structlist__files_html_a5ab6e21d40127aa921eca974d3573254"><div class="ttname"><a href="structlist__files.html#a5ab6e21d40127aa921eca974d3573254">list_files::current_file</a></div><div class="ttdeci">int current_file</div><div class="ttdoc">Puntero fichero muestra. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00025">fsm_rfid.h:25</a></div></div>
<div class="ttc" id="structlist__files_html"><div class="ttname"><a href="structlist__files.html">list_files</a></div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00023">fsm_rfid.h:23</a></div></div>
<div class="ttc" id="structlist__files_html_a70fbdb4ac81ecb8a257691170b40f4bb"><div class="ttname"><a href="structlist__files.html#a70fbdb4ac81ecb8a257691170b40f4bb">list_files::num_files</a></div><div class="ttdeci">int num_files</div><div class="ttdoc">Numero de ficheros totales. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00024">fsm_rfid.h:24</a></div></div>
<div class="ttc" id="structlist__files_html_ab8e9545f9cf8e60731a881b07d37a134"><div class="ttname"><a href="structlist__files.html#ab8e9545f9cf8e60731a881b07d37a134">list_files::select_file</a></div><div class="ttdeci">int select_file</div><div class="ttdoc">Puntero fichero Seleccionado. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00026">fsm_rfid.h:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d4c8489d18eb87542e04359532017f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d4c8489d18eb87542e04359532017f2">&#9670;&nbsp;</a></span>select_mode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void select_mode </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback de boton del encoder Activa el flag de seleccion del encoder. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">event</td><td>evento que se ha producido </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00630">630</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;{</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(7);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <a class="code" href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a> |= <a class="code" href="tipos_8h.html#a134bddded9af8032a0493fb55a84d41e">FLAG_IRQ_STEPPER_SELECT</a>;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(7);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;}</div><div class="ttc" id="mutex_8c_html_aa5fdb07cba530aae1495d95be367d04a"><div class="ttname"><a href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a></div><div class="ttdeci">void unlock(int key)</div><div class="ttdoc">desloquea el hilo actual </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00025">mutex.c:25</a></div></div>
<div class="ttc" id="mutex_8c_html_ad649ab53814d18a30bb40d7242961e23"><div class="ttname"><a href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a></div><div class="ttdeci">void lock(int key)</div><div class="ttdoc">Bloquea el hilo actual. </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00016">mutex.c:16</a></div></div>
<div class="ttc" id="tipos_8h_html_adbd4507c3dcdd7bd3aafd49ad3aba4cd"><div class="ttname"><a href="tipos_8h.html#adbd4507c3dcdd7bd3aafd49ad3aba4cd">stepper_irq_flag</a></div><div class="ttdeci">volatile uint8_t stepper_irq_flag</div><div class="ttdoc">flags del encoder </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00042">tipos.h:42</a></div></div>
<div class="ttc" id="tipos_8h_html_a134bddded9af8032a0493fb55a84d41e"><div class="ttname"><a href="tipos_8h.html#a134bddded9af8032a0493fb55a84d41e">FLAG_IRQ_STEPPER_SELECT</a></div><div class="ttdeci">#define FLAG_IRQ_STEPPER_SELECT</div><div class="ttdoc">Flag de pulsacion de selecion detectado. </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00036">tipos.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a25dc50da91baf30a6ef7a6cf3277ab4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25dc50da91baf30a6ef7a6cf3277ab4b">&#9670;&nbsp;</a></span>TarjetaDisponible()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TarjetaDisponible </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Condición de paso si hay una tarjeta insertada en el optoacoplador. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td>Maquina de estados </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Condición cumplida o no </dd></dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00126">126</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;{</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(0);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    uint8_t tmp = (<a class="code" href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a> &amp; <a class="code" href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaaff96c427210e75a502d2083d839844bb">FLAG_CARD_IN</a>);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(0);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div><div class="ttc" id="mutex_8c_html_aa5fdb07cba530aae1495d95be367d04a"><div class="ttname"><a href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a></div><div class="ttdeci">void unlock(int key)</div><div class="ttdoc">desloquea el hilo actual </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00025">mutex.c:25</a></div></div>
<div class="ttc" id="fsm__rfid_8h_html_abdc0ff505cbd4c3a6fc0eee64ca2ddcaaff96c427210e75a502d2083d839844bb"><div class="ttname"><a href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaaff96c427210e75a502d2083d839844bb">FLAG_CARD_IN</a></div><div class="ttdoc">Flag de tarjeta detectada optoacoplador. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00032">fsm_rfid.h:32</a></div></div>
<div class="ttc" id="mutex_8c_html_ad649ab53814d18a30bb40d7242961e23"><div class="ttname"><a href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a></div><div class="ttdeci">void lock(int key)</div><div class="ttdoc">Bloquea el hilo actual. </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00016">mutex.c:16</a></div></div>
<div class="ttc" id="tipos_8h_html_a23e04a79e83a0bb62dc3d6be4e0d1b92"><div class="ttname"><a href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a></div><div class="ttdeci">volatile uint8_t flag_rfid</div><div class="ttdoc">flags del rfid </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00041">tipos.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ce43ebc72dfc36e9b3f542ac4c42143"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ce43ebc72dfc36e9b3f542ac4c42143">&#9670;&nbsp;</a></span>TarjetaNoDisponible()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TarjetaNoDisponible </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Condición de paso si no hay una tarjeta insertada en el optoacoplador. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td>Maquina de estados </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Condición cumplida o no </dd></dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00139">139</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;{</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(0);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    uint8_t tmp = !(<a class="code" href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a> &amp; <a class="code" href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaaff96c427210e75a502d2083d839844bb">FLAG_CARD_IN</a>);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(0);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div><div class="ttc" id="mutex_8c_html_aa5fdb07cba530aae1495d95be367d04a"><div class="ttname"><a href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a></div><div class="ttdeci">void unlock(int key)</div><div class="ttdoc">desloquea el hilo actual </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00025">mutex.c:25</a></div></div>
<div class="ttc" id="fsm__rfid_8h_html_abdc0ff505cbd4c3a6fc0eee64ca2ddcaaff96c427210e75a502d2083d839844bb"><div class="ttname"><a href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaaff96c427210e75a502d2083d839844bb">FLAG_CARD_IN</a></div><div class="ttdoc">Flag de tarjeta detectada optoacoplador. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00032">fsm_rfid.h:32</a></div></div>
<div class="ttc" id="mutex_8c_html_ad649ab53814d18a30bb40d7242961e23"><div class="ttname"><a href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a></div><div class="ttdeci">void lock(int key)</div><div class="ttdoc">Bloquea el hilo actual. </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00016">mutex.c:16</a></div></div>
<div class="ttc" id="tipos_8h_html_a23e04a79e83a0bb62dc3d6be4e0d1b92"><div class="ttname"><a href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a></div><div class="ttdeci">volatile uint8_t flag_rfid</div><div class="ttdoc">flags del rfid </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00041">tipos.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7077c53d7693ce4e43ab1f3500ba7464"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7077c53d7693ce4e43ab1f3500ba7464">&#9670;&nbsp;</a></span>TarjetaNoValida()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TarjetaNoValida </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Condición de paso si la tarjeta no es RFID. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td>Maquina de estados </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Condición cumplida o no </dd></dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00165">165</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;{</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(0);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    uint8_t tmp = !(<a class="code" href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a> &amp; <a class="code" href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaae5f9e2292599b01b2028179e3f056e60">FLAG_VALID_CARD</a>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(0);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div><div class="ttc" id="mutex_8c_html_aa5fdb07cba530aae1495d95be367d04a"><div class="ttname"><a href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a></div><div class="ttdeci">void unlock(int key)</div><div class="ttdoc">desloquea el hilo actual </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00025">mutex.c:25</a></div></div>
<div class="ttc" id="mutex_8c_html_ad649ab53814d18a30bb40d7242961e23"><div class="ttname"><a href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a></div><div class="ttdeci">void lock(int key)</div><div class="ttdoc">Bloquea el hilo actual. </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00016">mutex.c:16</a></div></div>
<div class="ttc" id="fsm__rfid_8h_html_abdc0ff505cbd4c3a6fc0eee64ca2ddcaae5f9e2292599b01b2028179e3f056e60"><div class="ttname"><a href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaae5f9e2292599b01b2028179e3f056e60">FLAG_VALID_CARD</a></div><div class="ttdoc">Flag tarjeta valida RFID. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00033">fsm_rfid.h:33</a></div></div>
<div class="ttc" id="tipos_8h_html_a23e04a79e83a0bb62dc3d6be4e0d1b92"><div class="ttname"><a href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a></div><div class="ttdeci">volatile uint8_t flag_rfid</div><div class="ttdoc">flags del rfid </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00041">tipos.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2395018b43d089e28965e7993fc7796f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2395018b43d089e28965e7993fc7796f">&#9670;&nbsp;</a></span>TarjetaValida()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TarjetaValida </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fsm_8h.html#ac7a7d1813cdcb9d4c76f575416188504">fsm_t</a> *&#160;</td>
          <td class="paramname"><em>fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Condición de paso si la tarjeta es RFID. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fsm</td><td>Maquina de estados </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Condición cumplida o no </dd></dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00152">152</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a>(0);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    uint8_t tmp = <a class="code" href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a> &amp; <a class="code" href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaae5f9e2292599b01b2028179e3f056e60">FLAG_VALID_CARD</a>;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a>(0);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">return</span> tmp;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div><div class="ttc" id="mutex_8c_html_aa5fdb07cba530aae1495d95be367d04a"><div class="ttname"><a href="mutex_8c.html#aa5fdb07cba530aae1495d95be367d04a">unlock</a></div><div class="ttdeci">void unlock(int key)</div><div class="ttdoc">desloquea el hilo actual </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00025">mutex.c:25</a></div></div>
<div class="ttc" id="mutex_8c_html_ad649ab53814d18a30bb40d7242961e23"><div class="ttname"><a href="mutex_8c.html#ad649ab53814d18a30bb40d7242961e23">lock</a></div><div class="ttdeci">void lock(int key)</div><div class="ttdoc">Bloquea el hilo actual. </div><div class="ttdef"><b>Definition:</b> <a href="mutex_8c_source.html#l00016">mutex.c:16</a></div></div>
<div class="ttc" id="fsm__rfid_8h_html_abdc0ff505cbd4c3a6fc0eee64ca2ddcaae5f9e2292599b01b2028179e3f056e60"><div class="ttname"><a href="fsm__rfid_8h.html#abdc0ff505cbd4c3a6fc0eee64ca2ddcaae5f9e2292599b01b2028179e3f056e60">FLAG_VALID_CARD</a></div><div class="ttdoc">Flag tarjeta valida RFID. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00033">fsm_rfid.h:33</a></div></div>
<div class="ttc" id="tipos_8h_html_a23e04a79e83a0bb62dc3d6be4e0d1b92"><div class="ttname"><a href="tipos_8h.html#a23e04a79e83a0bb62dc3d6be4e0d1b92">flag_rfid</a></div><div class="ttdeci">volatile uint8_t flag_rfid</div><div class="ttdoc">flags del rfid </div><div class="ttdef"><b>Definition:</b> <a href="tipos_8h_source.html#l00041">tipos.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a7d69d31f9de9f46f7708405862da52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a7d69d31f9de9f46f7708405862da52">&#9670;&nbsp;</a></span>UUID_2_int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int UUID_2_int </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Conversor de Int Array a int del UUID. </p>
<dl class="section return"><dt>Returns</dt><dd>int UUID en formato int </dd></dl>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00570">570</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;{</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> id;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; 8; i++)</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordtype">id</span> = (<span class="keywordtype">id</span> &lt;&lt; 8) | <a class="code" href="fsm__rfid_8c.html#a414378ace9198797d96ba624749060e0">UUID</a>[i];</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">return</span> id;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;}</div><div class="ttc" id="fsm__rfid_8c_html_a414378ace9198797d96ba624749060e0"><div class="ttname"><a href="fsm__rfid_8c.html#a414378ace9198797d96ba624749060e0">UUID</a></div><div class="ttdeci">uint8_t UUID[16]</div><div class="ttdoc">Variable privada con el UUID de la ultima tarjeta. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00028">fsm_rfid.c:28</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="adc76c8cbae64e5426e49144ac52ac6d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc76c8cbae64e5426e49144ac52ac6d5">&#9670;&nbsp;</a></span>maquina_creada</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int maquina_creada = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indica si la maquina de estados ha sido creada ya o no. </p>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00032">32</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>

</div>
</div>
<a id="aefd9aadc5bca10986d4506c0b045be65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefd9aadc5bca10986d4506c0b045be65">&#9670;&nbsp;</a></span>seqA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int seqA</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00586">586</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>

</div>
</div>
<a id="a7f153a44052f2c810d14272facac0f82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f153a44052f2c810d14272facac0f82">&#9670;&nbsp;</a></span>seqB</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int seqB</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00587">587</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>

</div>
</div>
<a id="a1b63db81023235b2ef3108ad324a58f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b63db81023235b2ef3108ad324a58f8">&#9670;&nbsp;</a></span>transition_table_rfid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fsm_8h.html#a6b1de28e7a9f91913bb0499e2584b5ac">fsm_trans_t</a> transition_table_rfid[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">    {<a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030ad672f41b357cfe8db0e7b262a428fd66">WAIT_START</a>, <a class="code" href="fsm__rfid_8c.html#a894af73d089c430c2524bbb8015e749a">CompruebaComienzo</a>, <a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a5bca9eaafc1dfd8409ee779eda8537ad">WAIT_CARD</a>, <a class="code" href="fsm__rfid_8c.html#ab1f623c126d57fab4c99a247e7ba3766">ComienzaSistema</a>},</div><div class="line">    {<a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a5bca9eaafc1dfd8409ee779eda8537ad">WAIT_CARD</a>, <a class="code" href="fsm__rfid_8c.html#a25dc50da91baf30a6ef7a6cf3277ab4b">TarjetaDisponible</a>, <a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a1b68fba424de22ea2258e74face2ba0a">WAIT_CHECK</a>, <a class="code" href="fsm__rfid_8c.html#a1b8679a64ad408caa001f99dd8f4ef88">LeerTarjeta</a>},</div><div class="line">    {<a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a5bca9eaafc1dfd8409ee779eda8537ad">WAIT_CARD</a>, <a class="code" href="fsm__rfid_8c.html#a6ce43ebc72dfc36e9b3f542ac4c42143">TarjetaNoDisponible</a>, <a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a5bca9eaafc1dfd8409ee779eda8537ad">WAIT_CARD</a>, <a class="code" href="fsm__rfid_8c.html#a2bf6bef8226a73e69999b66ab1c4d1ce">EsperaTargeta</a>},</div><div class="line">    {<a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a1b68fba424de22ea2258e74face2ba0a">WAIT_CHECK</a>, <a class="code" href="fsm__rfid_8c.html#a7077c53d7693ce4e43ab1f3500ba7464">TarjetaNoValida</a>, <a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a5bca9eaafc1dfd8409ee779eda8537ad">WAIT_CARD</a>, <a class="code" href="fsm__rfid_8c.html#a2f0ba74b305da68c1f2969dd64042d8b">DescartaTarjeta</a>},</div><div class="line">    {<a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a1b68fba424de22ea2258e74face2ba0a">WAIT_CHECK</a>, <a class="code" href="fsm__rfid_8c.html#a2395018b43d089e28965e7993fc7796f">TarjetaValida</a>, <a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030ae78e2475a5f5995dbd42994a39b37926">WAIT_DATA</a>, <a class="code" href="fsm__rfid_8c.html#ac8fb7a4b36bbf4474338e0c399b0f10b">BuscaTarjeta</a>},</div><div class="line">    {<a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030ae78e2475a5f5995dbd42994a39b37926">WAIT_DATA</a>, TarjetaNoExiste, <a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a96589c1bca8da44e58c162ed39e17cd3">WAIT_PLAY</a>, <a class="code" href="fsm__rfid_8c.html#ad065142efd1af84e099b32e5c1d5b74e">ConfiguraTarjeta</a>},</div><div class="line">    {<a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030ae78e2475a5f5995dbd42994a39b37926">WAIT_DATA</a>, TarjetaExiste, <a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a96589c1bca8da44e58c162ed39e17cd3">WAIT_PLAY</a>, <a class="code" href="fsm__rfid_8c.html#a9557ef798d31cdbbe31de3713b8d9a3d">ComienzaReproduccion</a>},</div><div class="line">    {<a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a96589c1bca8da44e58c162ed39e17cd3">WAIT_PLAY</a>, <a class="code" href="fsm__rfid_8c.html#a25dc50da91baf30a6ef7a6cf3277ab4b">TarjetaDisponible</a>, <a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a96589c1bca8da44e58c162ed39e17cd3">WAIT_PLAY</a>, <a class="code" href="fsm__rfid_8c.html#a126312373885d78d67af9013bc12fa4e">CompruebaTarjeta</a>},</div><div class="line">    {<a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a96589c1bca8da44e58c162ed39e17cd3">WAIT_PLAY</a>, <a class="code" href="fsm__rfid_8c.html#a6ce43ebc72dfc36e9b3f542ac4c42143">TarjetaNoDisponible</a>, <a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030ad672f41b357cfe8db0e7b262a428fd66">WAIT_START</a>, <a class="code" href="fsm__rfid_8c.html#a5d872b86674c5ebc4e21793d76e75140">CancelaReproduccion</a>},</div><div class="line">    {<a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a96589c1bca8da44e58c162ed39e17cd3">WAIT_PLAY</a>, <a class="code" href="fsm__rfid_8c.html#aea3d64c12349f394154fb635e17c08f1">CompruebaFinalReproduccion</a>, <a class="code" href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030ad672f41b357cfe8db0e7b262a428fd66">WAIT_START</a>, <a class="code" href="fsm__rfid_8c.html#ad61e8abe347c0fe4e1fa343f2a3dde2f">FinalizaReproduccion</a>},</div><div class="line">    {-1, NULL, -1, NULL}}</div><div class="ttc" id="fsm__rfid_8c_html_aea3d64c12349f394154fb635e17c08f1"><div class="ttname"><a href="fsm__rfid_8c.html#aea3d64c12349f394154fb635e17c08f1">CompruebaFinalReproduccion</a></div><div class="ttdeci">int CompruebaFinalReproduccion(fsm_t *fsm)</div><div class="ttdoc">Condición de paso si Ha acabado la reproducción de la cancion. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00113">fsm_rfid.c:113</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a126312373885d78d67af9013bc12fa4e"><div class="ttname"><a href="fsm__rfid_8c.html#a126312373885d78d67af9013bc12fa4e">CompruebaTarjeta</a></div><div class="ttdeci">void CompruebaTarjeta(fsm_t *fsm)</div><div class="ttdoc">Funcion de espera de comprueba tarjeta. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00236">fsm_rfid.c:236</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a2f0ba74b305da68c1f2969dd64042d8b"><div class="ttname"><a href="fsm__rfid_8c.html#a2f0ba74b305da68c1f2969dd64042d8b">DescartaTarjeta</a></div><div class="ttdeci">void DescartaTarjeta(fsm_t *fsm)</div><div class="ttdoc">Altera el flag de tarjeta insertada. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00186">fsm_rfid.c:186</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a25dc50da91baf30a6ef7a6cf3277ab4b"><div class="ttname"><a href="fsm__rfid_8c.html#a25dc50da91baf30a6ef7a6cf3277ab4b">TarjetaDisponible</a></div><div class="ttdeci">int TarjetaDisponible(fsm_t *fsm)</div><div class="ttdoc">Condición de paso si hay una tarjeta insertada en el optoacoplador. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00126">fsm_rfid.c:126</a></div></div>
<div class="ttc" id="fsm__rfid_8h_html_ac5d3859d183e70214273d4a455dac030a96589c1bca8da44e58c162ed39e17cd3"><div class="ttname"><a href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a96589c1bca8da44e58c162ed39e17cd3">WAIT_PLAY</a></div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00039">fsm_rfid.h:39</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a1b8679a64ad408caa001f99dd8f4ef88"><div class="ttname"><a href="fsm__rfid_8c.html#a1b8679a64ad408caa001f99dd8f4ef88">LeerTarjeta</a></div><div class="ttdeci">void LeerTarjeta(fsm_t *fsm)</div><div class="ttdoc">Lee la tarjeta, activa el flag de tarjeta valida Lee la tarjeta, almacena en una variable privada del...</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00198">fsm_rfid.c:198</a></div></div>
<div class="ttc" id="fsm__rfid_8h_html_ac5d3859d183e70214273d4a455dac030a5bca9eaafc1dfd8409ee779eda8537ad"><div class="ttname"><a href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a5bca9eaafc1dfd8409ee779eda8537ad">WAIT_CARD</a></div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00040">fsm_rfid.h:40</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_ab1f623c126d57fab4c99a247e7ba3766"><div class="ttname"><a href="fsm__rfid_8c.html#ab1f623c126d57fab4c99a247e7ba3766">ComienzaSistema</a></div><div class="ttdeci">void ComienzaSistema(fsm_t *fsm)</div><div class="ttdoc">Funcion de Inicizalizacion del sistema. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00256">fsm_rfid.c:256</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_ad065142efd1af84e099b32e5c1d5b74e"><div class="ttname"><a href="fsm__rfid_8c.html#ad065142efd1af84e099b32e5c1d5b74e">ConfiguraTarjeta</a></div><div class="ttdeci">void ConfiguraTarjeta(fsm_t *fsm)</div><div class="ttdoc">Configura la tarjeta en la base de datos Muestra un menu por pantalla e inicializa las interrupciones...</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00342">fsm_rfid.c:342</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_ac8fb7a4b36bbf4474338e0c399b0f10b"><div class="ttname"><a href="fsm__rfid_8c.html#ac8fb7a4b36bbf4474338e0c399b0f10b">BuscaTarjeta</a></div><div class="ttdeci">void BuscaTarjeta(fsm_t *fsm)</div><div class="ttdoc">Funcion de Busqueda de la tarjeta en la Db Busca si existe la tarjeta en la base de datos...</div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00305">fsm_rfid.c:305</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a894af73d089c430c2524bbb8015e749a"><div class="ttname"><a href="fsm__rfid_8c.html#a894af73d089c430c2524bbb8015e749a">CompruebaComienzo</a></div><div class="ttdeci">int CompruebaComienzo(fsm_t *fsm)</div><div class="ttdoc">Funcion de arranque del sistema devuelve siempre 1. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00103">fsm_rfid.c:103</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a7077c53d7693ce4e43ab1f3500ba7464"><div class="ttname"><a href="fsm__rfid_8c.html#a7077c53d7693ce4e43ab1f3500ba7464">TarjetaNoValida</a></div><div class="ttdeci">int TarjetaNoValida(fsm_t *fsm)</div><div class="ttdoc">Condición de paso si la tarjeta no es RFID. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00165">fsm_rfid.c:165</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a5d872b86674c5ebc4e21793d76e75140"><div class="ttname"><a href="fsm__rfid_8c.html#a5d872b86674c5ebc4e21793d76e75140">CancelaReproduccion</a></div><div class="ttdeci">void CancelaReproduccion(fsm_t *fsm)</div><div class="ttdoc">Activa el flag de inicio de stop de la maquina de estados de player. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00225">fsm_rfid.c:225</a></div></div>
<div class="ttc" id="fsm__rfid_8h_html_ac5d3859d183e70214273d4a455dac030ae78e2475a5f5995dbd42994a39b37926"><div class="ttname"><a href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030ae78e2475a5f5995dbd42994a39b37926">WAIT_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00043">fsm_rfid.h:43</a></div></div>
<div class="ttc" id="fsm__rfid_8h_html_ac5d3859d183e70214273d4a455dac030a1b68fba424de22ea2258e74face2ba0a"><div class="ttname"><a href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030a1b68fba424de22ea2258e74face2ba0a">WAIT_CHECK</a></div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00041">fsm_rfid.h:41</a></div></div>
<div class="ttc" id="fsm__rfid_8h_html_ac5d3859d183e70214273d4a455dac030ad672f41b357cfe8db0e7b262a428fd66"><div class="ttname"><a href="fsm__rfid_8h.html#ac5d3859d183e70214273d4a455dac030ad672f41b357cfe8db0e7b262a428fd66">WAIT_START</a></div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8h_source.html#l00038">fsm_rfid.h:38</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a2395018b43d089e28965e7993fc7796f"><div class="ttname"><a href="fsm__rfid_8c.html#a2395018b43d089e28965e7993fc7796f">TarjetaValida</a></div><div class="ttdeci">int TarjetaValida(fsm_t *fsm)</div><div class="ttdoc">Condición de paso si la tarjeta es RFID. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00152">fsm_rfid.c:152</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a6ce43ebc72dfc36e9b3f542ac4c42143"><div class="ttname"><a href="fsm__rfid_8c.html#a6ce43ebc72dfc36e9b3f542ac4c42143">TarjetaNoDisponible</a></div><div class="ttdeci">int TarjetaNoDisponible(fsm_t *fsm)</div><div class="ttdoc">Condición de paso si no hay una tarjeta insertada en el optoacoplador. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00139">fsm_rfid.c:139</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a9557ef798d31cdbbe31de3713b8d9a3d"><div class="ttname"><a href="fsm__rfid_8c.html#a9557ef798d31cdbbe31de3713b8d9a3d">ComienzaReproduccion</a></div><div class="ttdeci">void ComienzaReproduccion(fsm_t *fsm)</div><div class="ttdoc">Activa el flag de inicio de reproduccion de la maquina de estados de player. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00212">fsm_rfid.c:212</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_ad61e8abe347c0fe4e1fa343f2a3dde2f"><div class="ttname"><a href="fsm__rfid_8c.html#ad61e8abe347c0fe4e1fa343f2a3dde2f">FinalizaReproduccion</a></div><div class="ttdeci">void FinalizaReproduccion(fsm_t *fsm)</div><div class="ttdoc">Funcion de finalizacion de reproduccion. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00245">fsm_rfid.c:245</a></div></div>
<div class="ttc" id="fsm__rfid_8c_html_a2bf6bef8226a73e69999b66ab1c4d1ce"><div class="ttname"><a href="fsm__rfid_8c.html#a2bf6bef8226a73e69999b66ab1c4d1ce">EsperaTargeta</a></div><div class="ttdeci">void EsperaTargeta(fsm_t *fsm)</div><div class="ttdoc">Funcion de espera de la tarjeta mientras no haya una en el optoacoplador. </div><div class="ttdef"><b>Definition:</b> <a href="fsm__rfid_8c_source.html#l00177">fsm_rfid.c:177</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00050">50</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>

</div>
</div>
<a id="a414378ace9198797d96ba624749060e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a414378ace9198797d96ba624749060e0">&#9670;&nbsp;</a></span>UUID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t UUID[16]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Variable privada con el UUID de la ultima tarjeta. </p>

<p class="definition">Definition at line <a class="el" href="fsm__rfid_8c_source.html#l00028">28</a> of file <a class="el" href="fsm__rfid_8c_source.html">fsm_rfid.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
